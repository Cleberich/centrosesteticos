{
    "sourceFile": "app/admin/rendimiento/page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1767148908253,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1767149123570,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -204,9 +204,9 @@\n               </p>\n             </div>\n           </div>\n           <a\n-            href=\"https://vercel.com/dashboard\"\n+            href=\"https://vercel.com/cleberichs-projects/barberias/analytics?source=project-overview-analytics-card&environment=all\"\n             target=\"_blank\"\n             className=\"px-6 py-3 bg-white text-black rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-200 transition-all\"\n           >\n             Abrir Vercel\n"
                },
                {
                    "date": 1767149186572,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,16 +125,16 @@\n             icon={<CalendarCheck size={20} />}\n             color=\"emerald\"\n             desc=\"Diciembre 2025\"\n           />\n-          <StatCard\n+        <a href=\"https://vercel.com/cleberichs-projects/barberias/analytics?source=project-overview-analytics-card&environment=all\" <StatCard\n             title=\"Visitas Web\"\n             value=\"Ver en Vercel\"\n             icon={<MousePointer2 size={20} />}\n             color=\"orange\"\n             desc=\"Tráfico Landing\"\n             isExternal\n-          />\n+          /></a>\n         </div>\n \n         {/* SECCIÓN DETALLE */}\n         <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n"
                }
            ],
            "date": 1767148908253,
            "name": "Commit-0",
            "content": "\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { \n  Users, \n  Store, \n  CalendarCheck, \n  TrendingUp, \n  Loader2, \n  ArrowUpRight, \n  MousePointer2,\n  Activity\n} from \"lucide-react\";\nimport { db } from \"@/services/firebase\";\nimport { collection, getDocs } from \"firebase/firestore\";\n\nexport default function AdminRendimientoPage() {\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState({\n    totalBarberias: 0,\n    totalBarberos: 0,\n    totalCitasMes: 0,\n    totalCitasHistoricas: 0,\n    crecimientoBarberias: 0\n  });\n\n  useEffect(() => {\n    const fetchGlobalStats = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, \"barberias\"));\n        let barberiasCount = 0;\n        let barberosCount = 0;\n        let citasMensuales = 0;\n        let citasTotales = 0;\n\n        const hoy = new Date();\n        const mesActual = hoy.getMonth();\n        const anioActual = hoy.getFullYear();\n\n        querySnapshot.forEach((doc) => {\n          const data = doc.data();\n          barberiasCount++;\n          \n          // Contar barberos de cada barbería\n          if (data.barbers) barberosCount += data.barbers.length;\n\n          // Analizar citas\n          if (data.appointments) {\n            data.appointments.forEach(app => {\n              citasTotales++;\n              const fechaApp = new Date(app.date || app.paidAt);\n              if (fechaApp.getMonth() === mesActual && fechaApp.getFullYear() === anioActual) {\n                citasMensuales++;\n              }\n            });\n          }\n        });\n\n        setStats({\n          totalBarberias: barberiasCount,\n          totalBarberos: barberosCount,\n          totalCitasMes: citasMensuales,\n          totalCitasHistoricas: citasTotales\n        });\n      } catch (error) {\n        console.error(\"Error cargando stats globales:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchGlobalStats();\n  }, []);\n\n  if (loading) return (\n    <div className=\"h-screen flex items-center justify-center bg-slate-950\">\n      <Loader2 className=\"animate-spin text-blue-600\" size={40} />\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white p-6 md:p-12 font-sans\">\n      <div className=\"max-w-7xl mx-auto space-y-10\">\n        \n        {/* HEADER */}\n        <header className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\n          <div>\n            <h1 className=\"text-4xl font-black uppercase italic tracking-tighter\">\n              Rendimiento <span className=\"text-blue-600\">Global</span>\n            </h1>\n            <p className=\"text-slate-500 font-bold uppercase text-[10px] tracking-widest mt-2\">\n              Estadísticas reales de la plataforma AgendaBarber\n            </p>\n          </div>\n          <div className=\"bg-blue-600/10 border border-blue-500/20 px-4 py-2 rounded-2xl flex items-center gap-3\">\n            <Activity className=\"text-blue-500 animate-pulse\" size={18} />\n            <span className=\"text-[10px] font-black uppercase tracking-widest\">Sistema Online</span>\n          </div>\n        </header>\n\n        {/* GRILLA DE ESTADÍSTICAS */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <StatCard \n            title=\"Barberías\" \n            value={stats.totalBarberias} \n            icon={<Store size={20} />} \n            color=\"blue\" \n            desc=\"Registradas\"\n          />\n          <StatCard \n            title=\"Barberos\" \n            value={stats.totalBarberos} \n            icon={<Users size={20} />} \n            color=\"purple\" \n            desc=\"Usuarios activos\"\n          />\n          <StatCard \n            title=\"Citas Mes\" \n            value={stats.totalCitasMes} \n            icon={<CalendarCheck size={20} />} \n            color=\"emerald\" \n            desc=\"Diciembre 2025\"\n          />\n          <StatCard \n            title=\"Visitas Web\" \n            value=\"Ver en Vercel\" \n            icon={<MousePointer2 size={20} />} \n            color=\"orange\" \n            desc=\"Tráfico Landing\"\n            isExternal\n          />\n        </div>\n\n        {/* SECCIÓN DETALLE */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2 bg-slate-900 border border-white/5 rounded-[2.5rem] p-8\">\n            <h3 className=\"text-lg font-black uppercase italic mb-6\">Crecimiento de Reservas</h3>\n            <div className=\"h-64 flex items-end gap-2\">\n              {/* Esto es una representación visual simple del volumen */}\n              {[30, 45, 25, 60, 75, 50, 90].map((h, i) => (\n                <div key={i} className=\"flex-1 bg-blue-600/20 rounded-t-xl hover:bg-blue-600 transition-all relative group\">\n                  <div style={{ height: `${h}%` }} className=\"bg-blue-600 rounded-t-xl w-full\" />\n                  <span className=\"absolute -top-8 left-1/2 -translate-x-1/2 text-[10px] font-bold opacity-0 group-hover:opacity-100 transition-opacity\">+{h}%</span>\n                </div>\n              ))}\n            </div>\n            <div className=\"flex justify-between mt-4 text-[10px] font-black uppercase text-slate-500 tracking-widest\">\n              <span>Jun</span><span>Jul</span><span>Ago</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dic</span>\n            </div>\n          </div>\n\n          <div className=\"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-[2.5rem] p-8 text-white flex flex-col justify-between shadow-2xl shadow-blue-500/20\">\n            <div>\n              <TrendingUp size={40} className=\"mb-6\" />\n              <h3 className=\"text-2xl font-black uppercase leading-tight\">Total de Citas <br/>Gestionadas</h3>\n              <p className=\"text-5xl font-black mt-4 tracking-tighter italic\">\n                {stats.totalCitasHistoricas.toLocaleString()}\n              </p>\n            </div>\n            <p className=\"text-[10px] font-bold uppercase opacity-60 tracking-[0.2em] mt-8\">\n              AgendaBarber Ecosystem\n            </p>\n          </div>\n        </div>\n\n        {/* ACCESO A VERCEL */}\n        <div className=\"bg-white/5 border border-white/10 rounded-3xl p-6 flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"size-12 bg-black rounded-xl flex items-center justify-center border border-white/10\">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 76 65\" fill=\"white\"><path d=\"M37.5274 0L75.0548 65H0L37.5274 0Z\"/></svg>\n            </div>\n            <div>\n              <p className=\"text-xs font-black uppercase tracking-widest\">Analítica de Visitas en Tiempo Real</p>\n              <p className=\"text-[10px] text-slate-500 font-bold uppercase\">Accede al panel de Vercel para ver procedencia y dispositivos</p>\n            </div>\n          </div>\n          <a \n            href=\"https://vercel.com/dashboard\" \n            target=\"_blank\" \n            className=\"px-6 py-3 bg-white text-black rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-slate-200 transition-all\"\n          >\n            Abrir Vercel\n          </a>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\nfunction StatCard({ title, value, icon, color, desc, isExternal }) {\n  const colors = {\n    blue: \"text-blue-500 bg-blue-500/10\",\n    purple: \"text-purple-500 bg-purple-500/10\",\n    emerald: \"text-emerald-500 bg-emerald-500/10\",\n    orange: \"text-orange-500 bg-orange-500/10\",\n  };\n\n  return (\n    <div className=\"bg-slate-900 border border-white/5 p-8 rounded-[2rem] hover:border-white/10 transition-all group\">\n      <div className=\"flex justify-between items-start mb-6\">\n        <div className={`p-3 rounded-2xl ${colors[color]}`}>\n          {icon}\n        </div>\n        <ArrowUpRight size={18} className=\"text-slate-700 group-hover:text-white transition-colors\" />\n      </div>\n      <p className=\"text-[10px] font-black uppercase text-slate-500 tracking-widest\">{title}</p>\n      <h2 className=\"text-3xl font-black mt-2 tracking-tighter italic\">\n        {value}\n      </h2>\n      <p className=\"text-[9px] font-bold text-slate-600 uppercase mt-1\">{desc}</p>\n    </div>\n  );\n}"
        }
    ]
}