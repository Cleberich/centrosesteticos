{
    "sourceFile": "app/admin/contol-panel/page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1767120301286,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1767120570871,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,18 +3,18 @@\n import React, { useState, useEffect } from \"react\";\n import { auth, db } from \"@/services/firebase\";\n import { onAuthStateChanged } from \"firebase/auth\";\n import { collection, getDocs, doc, updateDoc } from \"firebase/firestore\";\n-import { \n-  ShieldCheck, \n-  Search, \n-  ExternalLink, \n-  Loader2, \n-  AlertOctagon, \n-  CheckCircle2, \n-  CreditCard, \n+import {\n+  ShieldCheck,\n+  Search,\n+  ExternalLink,\n+  Loader2,\n+  AlertOctagon,\n+  CheckCircle2,\n+  CreditCard,\n   Calendar,\n-  Lock\n+  Lock,\n } from \"lucide-react\";\n \n export default function SuperAdminPage() {\n   const [user, setUser] = useState(null);\n@@ -41,20 +41,20 @@\n \n   const fetchBarberias = async () => {\n     try {\n       const querySnapshot = await getDocs(collection(db, \"barberias\"));\n-      const docs = querySnapshot.docs.map(doc => ({\n+      const docs = querySnapshot.docs.map((doc) => ({\n         id: doc.id,\n-        ...doc.data()\n+        ...doc.data(),\n       }));\n       setBarberias(docs);\n     } catch (error) {\n       console.error(\"Error cargando barberías:\", error);\n     }\n   };\n \n   const handleUpdatePayment = async (id, status) => {\n-    if(!window.confirm(\"¿Confirmar cambio de estado de pago?\")) return;\n+    if (!window.confirm(\"¿Confirmar cambio de estado de pago?\")) return;\n     try {\n       const docRef = doc(db, \"barberias\", id);\n       await updateDoc(docRef, { \"plan.paymentStatus\": status });\n       await fetchBarberias(); // Recargar\n@@ -62,44 +62,63 @@\n       alert(\"Error al actualizar\");\n     }\n   };\n \n-  const filteredBarberias = barberias.filter(b => \n-    b.businessName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n-    b.email?.toLowerCase().includes(searchTerm.toLowerCase())\n+  const filteredBarberias = barberias.filter(\n+    (b) =>\n+      b.businessName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n+      b.email?.toLowerCase().includes(searchTerm.toLowerCase())\n   );\n \n-  if (loading) return (\n-    <div className=\"h-screen flex items-center justify-center bg-[#0a0f1a]\">\n-      <Loader2 className=\"animate-spin text-blue-500\" size={40} />\n-    </div>\n-  );\n+  if (loading)\n+    return (\n+      <div className=\"h-screen flex items-center justify-center bg-[#0a0f1a]\">\n+        <Loader2 className=\"animate-spin text-blue-500\" size={40} />\n+      </div>\n+    );\n \n-  if (!isAuthorized) return (\n-    <div className=\"h-screen flex flex-col items-center justify-center bg-[#0a0f1a] p-6 text-center\">\n-      <div className=\"size-20 bg-red-500/10 rounded-full flex items-center justify-center mb-6\">\n-        <Lock className=\"text-red-500\" size={40} />\n+  if (!isAuthorized)\n+    return (\n+      <div className=\"h-screen flex flex-col items-center justify-center bg-[#0a0f1a] p-6 text-center\">\n+        <div className=\"size-20 bg-red-500/10 rounded-full flex items-center justify-center mb-6\">\n+          <Lock className=\"text-red-500\" size={40} />\n+        </div>\n+        <h1 className=\"text-2xl font-black uppercase tracking-tighter text-white\">\n+          Acceso Denegado\n+        </h1>\n+        <p className=\"text-slate-500 text-sm mt-2\">\n+          Solo el administrador principal puede ver esta página.\n+        </p>\n+        <a\n+          href=\"/\"\n+          className=\"mt-8 text-blue-500 font-bold uppercase text-[10px] tracking-widest\"\n+        >\n+          Volver al inicio\n+        </a>\n       </div>\n-      <h1 className=\"text-2xl font-black uppercase tracking-tighter text-white\">Acceso Denegado</h1>\n-      <p className=\"text-slate-500 text-sm mt-2\">Solo el administrador principal puede ver esta página.</p>\n-      <a href=\"/\" className=\"mt-8 text-blue-500 font-bold uppercase text-[10px] tracking-widest\">Volver al inicio</a>\n-    </div>\n-  );\n+    );\n \n   return (\n     <div className=\"min-h-screen bg-[#0a0f1a] text-slate-100 p-6 md:p-12\">\n       <header className=\"max-w-7xl mx-auto mb-12 flex flex-col md:flex-row md:items-center justify-between gap-6\">\n         <div>\n           <div className=\"flex items-center gap-2 mb-2\">\n             <ShieldCheck className=\"text-blue-500\" size={20} />\n-            <span className=\"text-[10px] font-black uppercase tracking-[0.3em] text-blue-500\">Super Admin Panel</span>\n+            <span className=\"text-[10px] font-black uppercase tracking-[0.3em] text-blue-500\">\n+              Super Admin Panel\n+            </span>\n           </div>\n-          <h1 className=\"text-4xl font-black uppercase tracking-tighter italic\">Control de <span className=\"text-blue-500\">Barberías</span></h1>\n+          <h1 className=\"text-4xl font-black uppercase tracking-tighter italic\">\n+            Control de <span className=\"text-blue-500\">Barberías</span>\n+          </h1>\n         </div>\n \n         <div className=\"relative group\">\n-          <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-blue-500 transition-colors\" size={18} />\n-          <input \n+          <Search\n+            className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-blue-500 transition-colors\"\n+            size={18}\n+          />\n+          <input\n             placeholder=\"BUSCAR POR NOMBRE O EMAIL...\"\n             className=\"bg-slate-900 border border-white/5 rounded-2xl py-4 pl-12 pr-6 w-full md:w-80 text-xs font-bold outline-none focus:border-blue-500 transition-all\"\n             onChange={(e) => setSearchTerm(e.target.value)}\n           />\n@@ -117,17 +136,30 @@\n             <span className=\"text-right\">Acciones</span>\n           </div>\n \n           {filteredBarberias.map((b) => (\n-            <div key={b.id} className=\"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6 md:px-8 flex flex-col md:grid md:grid-cols-5 items-center gap-6 hover:border-blue-500/30 transition-all\">\n+            <div\n+              key={b.id}\n+              className=\"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6 md:px-8 flex flex-col md:grid md:grid-cols-5 items-center gap-6 hover:border-blue-500/30 transition-all\"\n+            >\n               {/* Info Principal */}\n               <div className=\"flex items-center gap-4 w-full\">\n                 <div className=\"size-12 rounded-2xl bg-slate-800 border border-white/10 flex items-center justify-center overflow-hidden\">\n-                  {b.logo ? <img src={b.logo} className=\"w-full h-full object-cover\" /> : <span className=\"font-black text-blue-500\">{b.businessName?.[0]}</span>}\n+                  {b.logo ? (\n+                    <img src={b.logo} className=\"w-full h-full object-cover\" />\n+                  ) : (\n+                    <span className=\"font-black text-blue-500\">\n+                      {b.businessName?.[0]}\n+                    </span>\n+                  )}\n                 </div>\n                 <div>\n-                  <p className=\"font-black uppercase text-sm tracking-tight leading-none mb-1\">{b.businessName || \"Sin Nombre\"}</p>\n-                  <p className=\"text-[10px] text-slate-500 font-bold\">{b.email}</p>\n+                  <p className=\"font-black uppercase text-sm tracking-tight leading-none mb-1\">\n+                    {b.businessName || \"Sin Nombre\"}\n+                  </p>\n+                  <p className=\"text-[10px] text-slate-500 font-bold\">\n+                    {b.email}\n+                  </p>\n                 </div>\n               </div>\n \n               {/* Plan */}\n@@ -139,13 +171,26 @@\n               </div>\n \n               {/* Estado de Pago */}\n               <div className=\"w-full\">\n-                <button \n-                  onClick={() => handleUpdatePayment(b.id, b.plan?.paymentStatus === \"paid\" ? \"pending\" : \"paid\")}\n-                  className={`flex items-center gap-2 text-[10px] font-black uppercase tracking-widest transition-colors ${b.plan?.paymentStatus === \"paid\" ? \"text-emerald-500\" : \"text-amber-500\"}`}\n+                <button\n+                  onClick={() =>\n+                    handleUpdatePayment(\n+                      b.id,\n+                      b.plan?.paymentStatus === \"paid\" ? \"pending\" : \"paid\"\n+                    )\n+                  }\n+                  className={`flex items-center gap-2 text-[10px] font-black uppercase tracking-widest transition-colors ${\n+                    b.plan?.paymentStatus === \"paid\"\n+                      ? \"text-emerald-500\"\n+                      : \"text-amber-500\"\n+                  }`}\n                 >\n-                  {b.plan?.paymentStatus === \"paid\" ? <CheckCircle2 size={14} /> : <AlertOctagon size={14} />}\n+                  {b.plan?.paymentStatus === \"paid\" ? (\n+                    <CheckCircle2 size={14} />\n+                  ) : (\n+                    <AlertOctagon size={14} />\n+                  )}\n                   {b.plan?.paymentStatus === \"paid\" ? \"Pagado\" : \"Pendiente\"}\n                 </button>\n               </div>\n \n@@ -156,26 +201,31 @@\n               </div>\n \n               {/* Acciones */}\n               <div className=\"flex justify-end w-full gap-2\">\n-                <a \n-                  href={`/booking/${b.id}`} \n-                  target=\"_blank\" \n+                <a\n+                  href={`/booking/${b.id}`}\n+                  target=\"_blank\"\n                   className=\"p-3 bg-slate-800 hover:bg-blue-600 rounded-xl transition-all group\"\n                   title=\"Ver página pública\"\n                 >\n-                  <ExternalLink size={16} className=\"text-slate-400 group-hover:text-white\" />\n+                  <ExternalLink\n+                    size={16}\n+                    className=\"text-slate-400 group-hover:text-white\"\n+                  />\n                 </a>\n               </div>\n             </div>\n           ))}\n \n           {filteredBarberias.length === 0 && (\n             <div className=\"py-20 text-center bg-slate-900/20 rounded-[3rem] border border-dashed border-white/5\">\n-              <p className=\"text-slate-500 font-bold uppercase text-xs tracking-widest\">No se encontraron barberías registradas</p>\n\\ No newline at end of file\n+              <p className=\"text-slate-500 font-bold uppercase text-xs tracking-widest\">\n+                No se encontraron barberías registradas\n+              </p>\n             </div>\n           )}\n         </div>\n       </main>\n     </div>\n   );\n-}\n+}\n"
                }
            ],
            "date": 1767120301286,
            "name": "Commit-0",
            "content": "\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { auth, db } from \"@/services/firebase\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { collection, getDocs, doc, updateDoc } from \"firebase/firestore\";\nimport { \n  ShieldCheck, \n  Search, \n  ExternalLink, \n  Loader2, \n  AlertOctagon, \n  CheckCircle2, \n  CreditCard, \n  Calendar,\n  Lock\n} from \"lucide-react\";\n\nexport default function SuperAdminPage() {\n  const [user, setUser] = useState(null);\n  const [barberias, setBarberias] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [isAuthorized, setIsAuthorized] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  const ADMIN_EMAIL = \"cleberich@gmail.com\";\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\n      if (currentUser && currentUser.email === ADMIN_EMAIL) {\n        setUser(currentUser);\n        setIsAuthorized(true);\n        await fetchBarberias();\n      } else {\n        setIsAuthorized(false);\n      }\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const fetchBarberias = async () => {\n    try {\n      const querySnapshot = await getDocs(collection(db, \"barberias\"));\n      const docs = querySnapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      }));\n      setBarberias(docs);\n    } catch (error) {\n      console.error(\"Error cargando barberías:\", error);\n    }\n  };\n\n  const handleUpdatePayment = async (id, status) => {\n    if(!window.confirm(\"¿Confirmar cambio de estado de pago?\")) return;\n    try {\n      const docRef = doc(db, \"barberias\", id);\n      await updateDoc(docRef, { \"plan.paymentStatus\": status });\n      await fetchBarberias(); // Recargar\n    } catch (error) {\n      alert(\"Error al actualizar\");\n    }\n  };\n\n  const filteredBarberias = barberias.filter(b => \n    b.businessName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    b.email?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  if (loading) return (\n    <div className=\"h-screen flex items-center justify-center bg-[#0a0f1a]\">\n      <Loader2 className=\"animate-spin text-blue-500\" size={40} />\n    </div>\n  );\n\n  if (!isAuthorized) return (\n    <div className=\"h-screen flex flex-col items-center justify-center bg-[#0a0f1a] p-6 text-center\">\n      <div className=\"size-20 bg-red-500/10 rounded-full flex items-center justify-center mb-6\">\n        <Lock className=\"text-red-500\" size={40} />\n      </div>\n      <h1 className=\"text-2xl font-black uppercase tracking-tighter text-white\">Acceso Denegado</h1>\n      <p className=\"text-slate-500 text-sm mt-2\">Solo el administrador principal puede ver esta página.</p>\n      <a href=\"/\" className=\"mt-8 text-blue-500 font-bold uppercase text-[10px] tracking-widest\">Volver al inicio</a>\n    </div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-[#0a0f1a] text-slate-100 p-6 md:p-12\">\n      <header className=\"max-w-7xl mx-auto mb-12 flex flex-col md:flex-row md:items-center justify-between gap-6\">\n        <div>\n          <div className=\"flex items-center gap-2 mb-2\">\n            <ShieldCheck className=\"text-blue-500\" size={20} />\n            <span className=\"text-[10px] font-black uppercase tracking-[0.3em] text-blue-500\">Super Admin Panel</span>\n          </div>\n          <h1 className=\"text-4xl font-black uppercase tracking-tighter italic\">Control de <span className=\"text-blue-500\">Barberías</span></h1>\n        </div>\n\n        <div className=\"relative group\">\n          <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-blue-500 transition-colors\" size={18} />\n          <input \n            placeholder=\"BUSCAR POR NOMBRE O EMAIL...\"\n            className=\"bg-slate-900 border border-white/5 rounded-2xl py-4 pl-12 pr-6 w-full md:w-80 text-xs font-bold outline-none focus:border-blue-500 transition-all\"\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto\">\n        <div className=\"grid grid-cols-1 gap-4\">\n          {/* HEADER DE TABLA (Versión Desktop) */}\n          <div className=\"hidden md:grid grid-cols-5 px-8 py-4 text-[10px] font-black uppercase tracking-widest text-slate-500\">\n            <span>Barbería / Dueño</span>\n            <span>Plan Actual</span>\n            <span>Estado de Pago</span>\n            <span>Fecha de Vencimiento</span>\n            <span className=\"text-right\">Acciones</span>\n          </div>\n\n          {filteredBarberias.map((b) => (\n            <div key={b.id} className=\"bg-slate-900/50 border border-white/5 rounded-[2rem] p-6 md:px-8 flex flex-col md:grid md:grid-cols-5 items-center gap-6 hover:border-blue-500/30 transition-all\">\n              {/* Info Principal */}\n              <div className=\"flex items-center gap-4 w-full\">\n                <div className=\"size-12 rounded-2xl bg-slate-800 border border-white/10 flex items-center justify-center overflow-hidden\">\n                  {b.logo ? <img src={b.logo} className=\"w-full h-full object-cover\" /> : <span className=\"font-black text-blue-500\">{b.businessName?.[0]}</span>}\n                </div>\n                <div>\n                  <p className=\"font-black uppercase text-sm tracking-tight leading-none mb-1\">{b.businessName || \"Sin Nombre\"}</p>\n                  <p className=\"text-[10px] text-slate-500 font-bold\">{b.email}</p>\n                </div>\n              </div>\n\n              {/* Plan */}\n              <div className=\"w-full\">\n                <div className=\"inline-flex items-center gap-2 px-3 py-1 bg-blue-500/10 border border-blue-500/20 rounded-full text-blue-400 text-[10px] font-black uppercase\">\n                  <CreditCard size={12} />\n                  {b.plan?.type || \"Inicial\"}\n                </div>\n              </div>\n\n              {/* Estado de Pago */}\n              <div className=\"w-full\">\n                <button \n                  onClick={() => handleUpdatePayment(b.id, b.plan?.paymentStatus === \"paid\" ? \"pending\" : \"paid\")}\n                  className={`flex items-center gap-2 text-[10px] font-black uppercase tracking-widest transition-colors ${b.plan?.paymentStatus === \"paid\" ? \"text-emerald-500\" : \"text-amber-500\"}`}\n                >\n                  {b.plan?.paymentStatus === \"paid\" ? <CheckCircle2 size={14} /> : <AlertOctagon size={14} />}\n                  {b.plan?.paymentStatus === \"paid\" ? \"Pagado\" : \"Pendiente\"}\n                </button>\n              </div>\n\n              {/* Fecha de Pago */}\n              <div className=\"w-full flex items-center gap-2 text-slate-400 text-xs font-bold\">\n                <Calendar size={14} />\n                {b.plan?.expirationDate || \"N/A\"}\n              </div>\n\n              {/* Acciones */}\n              <div className=\"flex justify-end w-full gap-2\">\n                <a \n                  href={`/booking/${b.id}`} \n                  target=\"_blank\" \n                  className=\"p-3 bg-slate-800 hover:bg-blue-600 rounded-xl transition-all group\"\n                  title=\"Ver página pública\"\n                >\n                  <ExternalLink size={16} className=\"text-slate-400 group-hover:text-white\" />\n                </a>\n              </div>\n            </div>\n          ))}\n\n          {filteredBarberias.length === 0 && (\n            <div className=\"py-20 text-center bg-slate-900/20 rounded-[3rem] border border-dashed border-white/5\">\n              <p className=\"text-slate-500 font-bold uppercase text-xs tracking-widest\">No se encontraron barberías registradas</p>\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n}"
        }
    ]
}