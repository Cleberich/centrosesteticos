{
    "sourceFile": "app/dashboard/accounting/page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1766988912314,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766989101770,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,21 +1,14 @@\n \"use client\";\n import React, { useState, useMemo } from \"react\";\n-import {\n-  TrendingUp,\n-  Users,\n-  Calendar,\n-  DollarSign,\n-  ArrowUpRight,\n-  ArrowDownRight,\n-  Scissors,\n-  Download,\n+import { \n+  TrendingUp, Users, DollarSign, ArrowUpRight, \n+  Scissors, Download, ChevronRight, Wallet \n } from \"lucide-react\";\n \n export default function AccountingPage() {\n-  const [view, setView] = useState(\"dia\"); // dia, semana, mes\n+  const [view, setView] = useState(\"dia\");\n \n-  // Simulación de datos provenientes de las citas finalizadas\n   const stats = [\n     { id: 1, name: \"Juan Pérez\", services: 12, total: 240, commission: 120 },\n     { id: 2, name: \"Carlos Ruiz\", services: 8, total: 185, commission: 92.5 },\n     { id: 3, name: \"Miguel Ángel\", services: 15, total: 310, commission: 155 },\n@@ -26,161 +19,120 @@\n     [stats]\n   );\n \n   return (\n-    <div className=\"flex flex-col h-full bg-slate-50/50 dark:bg-[#0a0f1a] p-8 overflow-y-auto\">\n-      {/* HEADER DE CONTABILIDAD */}\n-      <header className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8\">\n+    <div className=\"flex flex-col h-full bg-[#f8fafc] dark:bg-[#0a0f1a] p-6 lg:p-10 overflow-y-auto\">\n+      {/* HEADER SEMÁNTICO */}\n+      <header className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-10\">\n         <div>\n-          <h1 className=\"text-2xl font-black dark:text-white uppercase tracking-tighter italic\">\n-            Caja y Comisiones\n+          <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white tracking-tight\">\n+            Contabilidad\n           </h1>\n-          <p className=\"text-sm text-slate-400 font-medium\">\n-            Reporte de ingresos generados por el equipo\n+          <p className=\"text-sm text-slate-500 dark:text-slate-400\">\n+            Resumen de ingresos y comisiones por barbero.\n           </p>\n         </div>\n \n-        <div className=\"flex items-center gap-2 bg-white dark:bg-slate-900 p-1 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800\">\n+        <div className=\"flex p-1 bg-slate-200/50 dark:bg-slate-800/50 rounded-xl backdrop-blur-sm\">\n           {[\"dia\", \"semana\", \"mes\"].map((t) => (\n             <button\n               key={t}\n               onClick={() => setView(t)}\n-              className={`px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${\n+              className={`px-5 py-2 rounded-lg text-xs font-bold transition-all uppercase tracking-wider ${\n                 view === t\n-                  ? \"bg-blue-600 text-white shadow-lg shadow-blue-500/20\"\n-                  : \"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200\"\n+                  ? \"bg-white dark:bg-slate-700 text-blue-600 dark:text-blue-400 shadow-sm\"\n+                  : \"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300\"\n               }`}\n             >\n               {t}\n             </button>\n           ))}\n         </div>\n       </header>\n \n-      {/* TARJETAS DE RESUMEN (KPIS) */}\n-      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n-        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n-          <div className=\"flex justify-between items-start mb-4\">\n-            <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-600 rounded-2xl\">\n-              <DollarSign size={24} />\n+      {/* KPIS REFINADOS */}\n+      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10\">\n+        {[\n+          { label: \"Total Bruto\", val: `$${totalGenerated}`, icon: <DollarSign size={20}/>, color: \"blue\", trend: \"+12.5%\" },\n+          { label: \"Servicios\", val: \"35\", icon: <Scissors size={20}/>, color: \"purple\", trend: null },\n+          { label: \"Neto Local\", val: `$${totalGenerated / 2}`, icon: <Wallet size={20}/>, color: \"emerald\", trend: \"+8.2%\" }\n+        ].map((kpi, i) => (\n+          <div key={i} className=\"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm transition-hover hover:shadow-md\">\n+            <div className=\"flex justify-between items-start mb-4\">\n+              <div className={`p-2.5 rounded-xl bg-${kpi.color}-50 dark:bg-${kpi.color}-500/10 text-${kpi.color}-600 dark:text-${kpi.color}-400`}>\n+                {kpi.icon}\n+              </div>\n+              {kpi.trend && (\n+                <span className=\"flex items-center text-[11px] font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 px-2 py-0.5 rounded-full\">\n+                  <ArrowUpRight size={12} className=\"mr-1\" /> {kpi.trend}\n+                </span>\n+              )}\n             </div>\n-            <span className=\"flex items-center text-emerald-500 text-xs font-bold bg-emerald-50 px-2 py-1 rounded-lg\">\n-              <ArrowUpRight size={14} /> +12%\n-            </span>\n+            <p className=\"text-[11px] font-bold text-slate-400 uppercase tracking-widest\">{kpi.label}</p>\n+            <h2 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-1\">{kpi.val}</h2>\n           </div>\n-          <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1\">\n-            Total Generado\n-          </p>\n-          <h2 className=\"text-3xl font-black dark:text-white\">\n-            ${totalGenerated.toLocaleString()}\n-          </h2>\n-        </div>\n+        ))}\n+      </div>\n \n-        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n-          <div className=\"flex justify-between items-start mb-4\">\n-            <div className=\"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-600 rounded-2xl\">\n-              <Scissors size={24} />\n-            </div>\n+      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n+        {/* TABLA: OCUPA 2 COLUMNAS */}\n+        <div className=\"lg:col-span-2 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm\">\n+          <div className=\"px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center\">\n+            <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider\">Desempeño del Equipo</h3>\n+            <button className=\"text-blue-600 dark:text-blue-400 text-xs font-bold flex items-center gap-1 hover:underline\">\n+              <Download size={14} /> Reporte PDF\n+            </button>\n           </div>\n-          <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1\">\n-            Servicios Totales\n-          </p>\n-          <h2 className=\"text-3xl font-black dark:text-white\">35</h2>\n-        </div>\n-\n-        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm text-white bg-gradient-to-br from-blue-600 to-indigo-700\">\n-          <div className=\"flex justify-between items-start mb-4 text-white/80\">\n-            <Users size={24} />\n+          <div className=\"overflow-x-auto\">\n+            <table className=\"w-full text-left\">\n+              <thead>\n+                <tr className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest border-b border-slate-50 dark:border-slate-800\">\n+                  <th className=\"px-6 py-4\">Barbero</th>\n+                  <th className=\"px-6 py-4 text-center\">Servicios</th>\n+                  <th className=\"px-6 py-4\">Comisión</th>\n+                  <th className=\"px-6 py-4 text-right\">Monto Local</th>\n+                </tr>\n+              </thead>\n+              <tbody className=\"divide-y divide-slate-50 dark:divide-slate-800\">\n+                {stats.map((b) => (\n+                  <tr key={b.id} className=\"group hover:bg-slate-50 dark:hover:bg-slate-800/40 transition-colors\">\n+                    <td className=\"px-6 py-4\">\n+                      <div className=\"flex items-center gap-3\">\n+                        <div className=\"size-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-600 dark:text-slate-400 text-xs\">\n+                          {b.name.split(' ').map(n => n[0]).join('')}\n+                        </div>\n+                        <span className=\"text-sm font-bold text-slate-700 dark:text-slate-200\">{b.name}</span>\n+                      </div>\n+                    </td>\n+                    <td className=\"px-6 py-4 text-center text-sm text-slate-500 font-medium\">{b.services}</td>\n+                    <td className=\"px-6 py-4 text-sm font-semibold text-orange-600 dark:text-orange-400\">${b.commission}</td>\n+                    <td className=\"px-6 py-4 text-right text-sm font-bold text-emerald-600 dark:text-emerald-400\">${b.total - b.commission}</td>\n+                  </tr>\n+                ))}\n+              </tbody>\n+            </table>\n           </div>\n-          <p className=\"text-[10px] font-black text-white/60 uppercase tracking-widest mb-1\">\n-            Top Barbero\n-          </p>\n-          <h2 className=\"text-2xl font-black\">Miguel Ángel</h2>\n-          <p className=\"text-xs text-white/80 mt-1\">$310 hoy</p>\n         </div>\n-      </div>\n \n-      {/* TABLA DE DETALLE POR BARBERO */}\n-      <div className=\"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden\">\n-        <div className=\"p-8 border-b border-slate-50 dark:border-slate-800 flex justify-between items-center\">\n-          <h3 className=\"font-bold dark:text-white\">\n-            Rendimiento del Personal\n-          </h3>\n-          <button className=\"flex items-center gap-2 text-xs font-bold text-blue-600 hover:bg-blue-50 p-2 px-4 rounded-xl transition-all\">\n-            <Download size={16} /> Exportar\n-          </button>\n-        </div>\n-\n-        <table className=\"w-full text-left border-collapse\">\n-          <thead>\n-            <tr className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] bg-slate-50/50 dark:bg-slate-800/50\">\n-              <th className=\"px-8 py-4\">Barbero</th>\n-              <th className=\"px-8 py-4\">Servicios</th>\n-              <th className=\"px-8 py-4\">Bruto</th>\n-              <th className=\"px-8 py-4\">Comisión (50%)</th>\n-              <th className=\"px-8 py-4 text-right\">Neto Local</th>\n-            </tr>\n-          </thead>\n-          <tbody className=\"divide-y divide-slate-50 dark:divide-slate-800\">\n-            {stats.map((barber) => (\n-              <tr\n-                key={barber.id}\n-                className=\"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors\"\n-              >\n-                <td className=\"px-8 py-5\">\n-                  <div className=\"flex items-center gap-3\">\n-                    <div className=\"size-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-blue-600 font-bold\">\n-                      {barber.name.charAt(0)}\n-                    </div>\n-                    <span className=\"font-bold dark:text-white text-sm\">\n-                      {barber.name}\n-                    </span>\n+        {/* GRÁFICO SIMPLIFICADO: OCUPA 1 COLUMNA */}\n+        <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 flex flex-col\">\n+          <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider mb-8\">Volumen Semanal</h3>\n+          <div className=\"flex-1 flex items-end justify-between gap-2 h-40 px-2\">\n+            {[30, 50, 45, 80, 60, 90, 40].map((h, i) => (\n+              <div key={i} className=\"group relative flex-1 flex flex-col items-center\">\n+                <div \n+                  className=\"w-full bg-blue-100 dark:bg-blue-900/30 group-hover:bg-blue-600 transition-all rounded-t-md relative\"\n+                  style={{ height: `${h}%` }}\n+                >\n+                  <div className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-[10px] py-1 px-2 rounded opacity-0 group-hover:opacity-100 transition-opacity\">\n+                    ${h*5}\n                   </div>\n-                </td>\n-                <td className=\"px-8 py-5\">\n-                  <span className=\"text-sm font-medium text-slate-600 dark:text-slate-400\">\n-                    {barber.services} cortes\n-                  </span>\n-                </td>\n-                <td className=\"px-8 py-5\">\n-                  <span className=\"text-sm font-black dark:text-white\">\n-                    ${barber.total}\n-                  </span>\n-                </td>\n-                <td className=\"px-8 py-5\">\n-                  <span className=\"text-sm font-bold text-orange-500\">\n-                    ${barber.commission}\n-                  </span>\n-                </td>\n-                <td className=\"px-8 py-5 text-right\">\n-                  <span className=\"text-sm font-black text-emerald-500\">\n-                    ${barber.total - barber.commission}\n-                  </span>\n-                </td>\n-              </tr>\n+                </div>\n+                <span className=\"text-[9px] font-bold text-slate-400 mt-3\">{['L','M','X','J','V','S','D'][i]}</span>\n+              </div>\n             ))}\n-          </tbody>\n-        </table>\n-      </div>\n-\n-      {/* GRÁFICO SIMPLE (SIMULADO CON BARRAS) */}\n-      <div className=\"mt-8 bg-white dark:bg-slate-900 p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n-        <h3 className=\"font-bold mb-8 dark:text-white\">\n-          Flujo de Ingresos ({view})\n-        </h3>\n-        <div className=\"flex items-end gap-4 h-48\">\n-          {[40, 70, 45, 90, 65, 80, 50].map((h, i) => (\n-            <div key={i} className=\"flex-1 flex flex-col items-center gap-2\">\n-              <div\n-                className=\"w-full bg-blue-600/10 hover:bg-blue-600 rounded-t-xl transition-all cursor-pointer\"\n-                style={{ height: `${h}%` }}\n-              />\n-              <span className=\"text-[9px] font-bold text-slate-400 uppercase\">\n-                Día {i + 1}\n-              </span>\n-            </div>\n-          ))}\n+          </div>\n         </div>\n       </div>\n     </div>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1767030566328,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,42 +1,111 @@\n \"use client\";\n-import React, { useState, useMemo } from \"react\";\n+import React, { useState, useEffect, useMemo } from \"react\";\n import {\n-  TrendingUp,\n-  Users,\n   DollarSign,\n   ArrowUpRight,\n   Scissors,\n   Download,\n-  ChevronRight,\n   Wallet,\n+  Loader2,\n } from \"lucide-react\";\n+// Firebase\n+import { auth, db } from \"@/services/firebase\";\n+import { onAuthStateChanged } from \"firebase/auth\";\n+import { doc, getDoc } from \"firebase/firestore\";\n \n export default function AccountingPage() {\n-  const [view, setView] = useState(\"dia\");\n+  const [view, setView] = useState(\"dia\"); // dia, semana, mes\n+  const [loading, setLoading] = useState(true);\n+  const [barberiaData, setBarberiaData] = useState(null);\n \n-  const stats = [\n-    { id: 1, name: \"Juan Pérez\", services: 12, total: 240, commission: 120 },\n-    { id: 2, name: \"Carlos Ruiz\", services: 8, total: 185, commission: 92.5 },\n-    { id: 3, name: \"Miguel Ángel\", services: 15, total: 310, commission: 155 },\n-  ];\n+  // --- 1. CARGA DE DATOS REALES ---\n+  useEffect(() => {\n+    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n+      if (user) {\n+        try {\n+          const docRef = doc(db, \"barberias\", user.uid);\n+          const docSnap = await getDoc(docRef);\n+          if (docSnap.exists()) {\n+            setBarberiaData(docSnap.data());\n+          }\n+        } catch (error) {\n+          console.error(\"Error al cargar contabilidad:\", error);\n+        } finally {\n+          setLoading(false);\n+        }\n+      }\n+    });\n+    return () => unsubscribe();\n+  }, []);\n \n-  const totalGenerated = useMemo(\n-    () => stats.reduce((acc, curr) => acc + curr.total, 0),\n-    [stats]\n+  // --- 2. LÓGICA DE FILTRADO Y CÁLCULOS ---\n+  const accountingData = useMemo(() => {\n+    if (!barberiaData || !barberiaData.appointments) return { stats: [], totalBruto: 0, totalServicios: 0, netoLocal: 0 };\n+\n+    const hoy = new Date();\n+    const barberStats = {};\n+\n+    // Inicializar barberos registrados\n+    (barberiaData.barbers || []).forEach(b => {\n+      barberStats[b.name] = { name: b.name, services: 0, total: 0, commission: 0 };\n+    });\n+\n+    const filteredApps = barberiaData.appointments.filter((app) => {\n+      const appDate = new Date(app.paidAt || app.start);\n+      if (isNaN(appDate)) return false;\n+\n+      if (view === \"dia\") {\n+        return appDate.toDateString() === hoy.toDateString();\n+      } else if (view === \"semana\") {\n+        const haceSieteDias = new Date();\n+        haceSieteDias.setDate(hoy.getDate() - 7);\n+        return appDate >= haceSieteDias;\n+      } else if (view === \"mes\") {\n+        return appDate.getMonth() === hoy.getMonth() && appDate.getFullYear() === hoy.getFullYear();\n+      }\n+      return true;\n+    });\n+\n+    filteredApps.forEach((app) => {\n+      const barberName = app.barber || \"Sin asignar\";\n+      const monto = Number(app.total) || 0;\n+      \n+      if (!barberStats[barberName]) {\n+        barberStats[barberName] = { name: barberName, services: 0, total: 0, commission: 0 };\n+      }\n+\n+      barberStats[barberName].services += 1;\n+      barberStats[barberName].total += monto;\n+      // Suponiendo comisión del 50%, ajustable según tu lógica\n+      barberStats[barberName].commission += monto * 0.5; \n+    });\n+\n+    const statsArray = Object.values(barberStats).filter(b => b.services > 0);\n+    const totalBruto = statsArray.reduce((acc, curr) => acc + curr.total, 0);\n+    const totalServicios = filteredApps.length;\n+    const totalComisiones = statsArray.reduce((acc, curr) => acc + curr.commission, 0);\n+\n+    return {\n+      stats: statsArray,\n+      totalBruto,\n+      totalServicios,\n+      netoLocal: totalBruto - totalComisiones\n+    };\n+  }, [barberiaData, view]);\n+\n+  if (loading) return (\n+    <div className=\"flex-1 flex items-center justify-center bg-white dark:bg-[#0a0f1a]\">\n+      <Loader2 className=\"text-blue-600 animate-spin\" size={40} />\n+    </div>\n   );\n \n   return (\n     <div className=\"flex flex-col h-full bg-[#f8fafc] dark:bg-[#0a0f1a] p-6 lg:p-10 overflow-y-auto\">\n-      {/* HEADER SEMÁNTICO */}\n       <header className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-10\">\n         <div>\n-          <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white tracking-tight\">\n-            Contabilidad\n-          </h1>\n-          <p className=\"text-sm text-slate-500 dark:text-slate-400\">\n-            Resumen de ingresos y comisiones por barbero.\n-          </p>\n+          <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white tracking-tight\">Contabilidad</h1>\n+          <p className=\"text-sm text-slate-500 dark:text-slate-400\">Resumen de ingresos y comisiones por barbero.</p>\n         </div>\n \n         <div className=\"flex p-1 bg-slate-200/50 dark:bg-slate-800/50 rounded-xl backdrop-blur-sm\">\n           {[\"dia\", \"semana\", \"mes\"].map((t) => (\n@@ -54,66 +123,18 @@\n           ))}\n         </div>\n       </header>\n \n-      {/* KPIS REFINADOS */}\n       <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10\">\n-        {[\n-          {\n-            label: \"Total Bruto\",\n-            val: `$${totalGenerated}`,\n-            icon: <DollarSign size={20} />,\n-            color: \"blue\",\n-            trend: \"+12.5%\",\n-          },\n-          {\n-            label: \"Servicios\",\n-            val: \"35\",\n-            icon: <Scissors size={20} />,\n-            color: \"purple\",\n-            trend: null,\n-          },\n-          {\n-            label: \"Neto Local\",\n-            val: `$${totalGenerated / 2}`,\n-            icon: <Wallet size={20} />,\n-            color: \"emerald\",\n-            trend: \"+8.2%\",\n-          },\n-        ].map((kpi, i) => (\n-          <div\n-            key={i}\n-            className=\"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm transition-hover hover:shadow-md\"\n-          >\n-            <div className=\"flex justify-between items-start mb-4\">\n-              <div\n-                className={`p-2.5 rounded-xl bg-${kpi.color}-50 dark:bg-${kpi.color}-500/10 text-${kpi.color}-600 dark:text-${kpi.color}-400`}\n-              >\n-                {kpi.icon}\n-              </div>\n-              {kpi.trend && (\n-                <span className=\"flex items-center text-[11px] font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 px-2 py-0.5 rounded-full\">\n-                  <ArrowUpRight size={12} className=\"mr-1\" /> {kpi.trend}\n-                </span>\n-              )}\n-            </div>\n-            <p className=\"text-[11px] font-bold text-slate-400 uppercase tracking-widest\">\n-              {kpi.label}\n-            </p>\n-            <h2 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-1\">\n-              {kpi.val}\n-            </h2>\n-          </div>\n-        ))}\n+        <KpiCard label=\"Total Bruto\" value={`$${accountingData.totalBruto.toLocaleString()}`} icon={<DollarSign size={20} />} color=\"blue\" trend=\"+12%\" />\n+        <KpiCard label=\"Servicios\" value={accountingData.totalServicios.toString()} icon={<Scissors size={20} />} color=\"purple\" />\n+        <KpiCard label=\"Neto Local\" value={`$${accountingData.netoLocal.toLocaleString()}`} icon={<Wallet size={20} />} color=\"emerald\" trend=\"+8%\" />\n       </div>\n \n       <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n-        {/* TABLA: OCUPA 2 COLUMNAS */}\n         <div className=\"lg:col-span-2 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm\">\n           <div className=\"px-6 py-5 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center\">\n-            <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider\">\n-              Desempeño del Equipo\n-            </h3>\n+            <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider\">Desempeño del Equipo</h3>\n             <button className=\"text-blue-600 dark:text-blue-400 text-xs font-bold flex items-center gap-1 hover:underline\">\n               <Download size={14} /> Reporte PDF\n             </button>\n           </div>\n@@ -122,73 +143,71 @@\n               <thead>\n                 <tr className=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest border-b border-slate-50 dark:border-slate-800\">\n                   <th className=\"px-6 py-4\">Barbero</th>\n                   <th className=\"px-6 py-4 text-center\">Servicios</th>\n-                  <th className=\"px-6 py-4\">Comisión</th>\n+                  <th className=\"px-6 py-4\">Comisión (50%)</th>\n                   <th className=\"px-6 py-4 text-right\">Monto Local</th>\n                 </tr>\n               </thead>\n               <tbody className=\"divide-y divide-slate-50 dark:divide-slate-800\">\n-                {stats.map((b) => (\n-                  <tr\n-                    key={b.id}\n-                    className=\"group hover:bg-slate-50 dark:hover:bg-slate-800/40 transition-colors\"\n-                  >\n+                {accountingData.stats.map((b, i) => (\n+                  <tr key={i} className=\"group hover:bg-slate-50 dark:hover:bg-slate-800/40 transition-colors\">\n                     <td className=\"px-6 py-4\">\n                       <div className=\"flex items-center gap-3\">\n-                        <div className=\"size-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-600 dark:text-slate-400 text-xs\">\n-                          {b.name\n-                            .split(\" \")\n-                            .map((n) => n[0])\n-                            .join(\"\")}\n+                        <div className=\"size-8 rounded-lg bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-600 dark:text-slate-400 text-xs uppercase italic\">\n+                          {b.name.charAt(0)}\n                         </div>\n-                        <span className=\"text-sm font-bold text-slate-700 dark:text-slate-200\">\n-                          {b.name}\n-                        </span>\n+                        <span className=\"text-sm font-bold text-slate-700 dark:text-slate-200\">{b.name}</span>\n                       </div>\n                     </td>\n-                    <td className=\"px-6 py-4 text-center text-sm text-slate-500 font-medium\">\n-                      {b.services}\n-                    </td>\n-                    <td className=\"px-6 py-4 text-sm font-semibold text-orange-600 dark:text-orange-400\">\n-                      ${b.commission}\n-                    </td>\n-                    <td className=\"px-6 py-4 text-right text-sm font-bold text-emerald-600 dark:text-emerald-400\">\n-                      ${b.total - b.commission}\n-                    </td>\n+                    <td className=\"px-6 py-4 text-center text-sm text-slate-500 font-medium\">{b.services}</td>\n+                    <td className=\"px-6 py-4 text-sm font-semibold text-orange-600 dark:text-orange-400\">${b.commission.toLocaleString()}</td>\n+                    <td className=\"px-6 py-4 text-right text-sm font-bold text-emerald-600 dark:text-emerald-400\">${(b.total - b.commission).toLocaleString()}</td>\n                   </tr>\n                 ))}\n               </tbody>\n             </table>\n           </div>\n         </div>\n \n-        {/* GRÁFICO SIMPLIFICADO: OCUPA 1 COLUMNA */}\n         <div className=\"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm p-6 flex flex-col\">\n-          <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider mb-8\">\n-            Volumen Semanal\n-          </h3>\n+          <h3 className=\"text-sm font-bold text-slate-800 dark:text-slate-100 uppercase tracking-wider mb-8\">Volumen Diario</h3>\n           <div className=\"flex-1 flex items-end justify-between gap-2 h-40 px-2\">\n             {[30, 50, 45, 80, 60, 90, 40].map((h, i) => (\n-              <div\n-                key={i}\n-                className=\"group relative flex-1 flex flex-col items-center\"\n-              >\n-                <div\n-                  className=\"w-full bg-blue-100 dark:bg-blue-900/30 group-hover:bg-blue-600 transition-all rounded-t-md relative\"\n-                  style={{ height: `${h}%` }}\n-                >\n-                  <div className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-[10px] py-1 px-2 rounded opacity-0 group-hover:opacity-100 transition-opacity\">\n-                    ${h * 5}\n+              <div key={i} className=\"group relative flex-1 flex flex-col items-center\">\n+                <div className=\"w-full bg-blue-100 dark:bg-blue-900/30 group-hover:bg-blue-600 transition-all rounded-t-md relative\" style={{ height: `${h}%` }}>\n+                   <div className=\"absolute -top-8 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-[10px] py-1 px-2 rounded opacity-0 group-hover:opacity-100 transition-opacity\">\n+                    Vol: {h}%\n                   </div>\n                 </div>\n-                <span className=\"text-[9px] font-bold text-slate-400 mt-3\">\n-                  {[\"L\", \"M\", \"X\", \"J\", \"V\", \"S\", \"D\"][i]}\n-                </span>\n+                <span className=\"text-[9px] font-bold text-slate-400 mt-3 uppercase\">{[\"L\", \"M\", \"X\", \"J\", \"V\", \"S\", \"D\"][i]}</span>\n               </div>\n             ))}\n           </div>\n         </div>\n       </div>\n     </div>\n   );\n }\n+\n+// Subcomponente para KPIs\n+function KpiCard({ label, value, icon, color, trend }) {\n+  const colors = {\n+    blue: \"bg-blue-50 dark:bg-blue-500/10 text-blue-600 dark:text-blue-400\",\n+    purple: \"bg-purple-50 dark:bg-purple-500/10 text-purple-600 dark:text-purple-400\",\n+    emerald: \"bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400\",\n+  };\n+  return (\n+    <div className=\"bg-white dark:bg-slate-900 p-6 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-sm\">\n+      <div className=\"flex justify-between items-start mb-4\">\n+        <div className={`p-2.5 rounded-xl ${colors[color]}`}>{icon}</div>\n+        {trend && (\n+          <span className=\"flex items-center text-[11px] font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 px-2 py-0.5 rounded-full\">\n+            <ArrowUpRight size={12} className=\"mr-1\" /> {trend}\n+          </span>\n+        )}\n+      </div>\n+      <p className=\"text-[11px] font-black text-slate-400 uppercase tracking-widest\">{label}</p>\n+      <h2 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-1 tracking-tighter\">{value}</h2>\n+    </div>\n+  );\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1766988912314,
            "name": "Commit-0",
            "content": "\"use client\";\nimport React, { useState, useMemo } from \"react\";\nimport { \n  TrendingUp, Users, Calendar, DollarSign, \n  ArrowUpRight, ArrowDownRight, Scissors, Download \n} from \"lucide-react\";\n\nexport default function AccountingPage() {\n  const [view, setView] = useState(\"dia\"); // dia, semana, mes\n\n  // Simulación de datos provenientes de las citas finalizadas\n  const stats = [\n    { id: 1, name: \"Juan Pérez\", services: 12, total: 240, commission: 120 },\n    { id: 2, name: \"Carlos Ruiz\", services: 8, total: 185, commission: 92.5 },\n    { id: 3, name: \"Miguel Ángel\", services: 15, total: 310, commission: 155 },\n  ];\n\n  const totalGenerated = useMemo(() => stats.reduce((acc, curr) => acc + curr.total, 0), [stats]);\n\n  return (\n    <div className=\"flex flex-col h-full bg-slate-50/50 dark:bg-[#0a0f1a] p-8 overflow-y-auto\">\n      {/* HEADER DE CONTABILIDAD */}\n      <header className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8\">\n        <div>\n          <h1 className=\"text-2xl font-black dark:text-white uppercase tracking-tighter italic\">Caja y Comisiones</h1>\n          <p className=\"text-sm text-slate-400 font-medium\">Reporte de ingresos generados por el equipo</p>\n        </div>\n\n        <div className=\"flex items-center gap-2 bg-white dark:bg-slate-900 p-1 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800\">\n          {[\"dia\", \"semana\", \"mes\"].map((t) => (\n            <button\n              key={t}\n              onClick={() => setView(t)}\n              className={`px-6 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${\n                view === t \n                ? \"bg-blue-600 text-white shadow-lg shadow-blue-500/20\" \n                : \"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200\"\n              }`}\n            >\n              {t}\n            </button>\n          ))}\n        </div>\n      </header>\n\n      {/* TARJETAS DE RESUMEN (KPIS) */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n          <div className=\"flex justify-between items-start mb-4\">\n            <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 text-blue-600 rounded-2xl\">\n              <DollarSign size={24} />\n            </div>\n            <span className=\"flex items-center text-emerald-500 text-xs font-bold bg-emerald-50 px-2 py-1 rounded-lg\">\n              <ArrowUpRight size={14} /> +12%\n            </span>\n          </div>\n          <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1\">Total Generado</p>\n          <h2 className=\"text-3xl font-black dark:text-white\">${totalGenerated.toLocaleString()}</h2>\n        </div>\n\n        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n          <div className=\"flex justify-between items-start mb-4\">\n            <div className=\"p-3 bg-purple-50 dark:bg-purple-900/20 text-purple-600 rounded-2xl\">\n              <Scissors size={24} />\n            </div>\n          </div>\n          <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1\">Servicios Totales</p>\n          <h2 className=\"text-3xl font-black dark:text-white\">35</h2>\n        </div>\n\n        <div className=\"bg-white dark:bg-slate-900 p-6 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm text-white bg-gradient-to-br from-blue-600 to-indigo-700\">\n          <div className=\"flex justify-between items-start mb-4 text-white/80\">\n            <Users size={24} />\n          </div>\n          <p className=\"text-[10px] font-black text-white/60 uppercase tracking-widest mb-1\">Top Barbero</p>\n          <h2 className=\"text-2xl font-black\">Miguel Ángel</h2>\n          <p className=\"text-xs text-white/80 mt-1\">$310 hoy</p>\n        </div>\n      </div>\n\n      {/* TABLA DE DETALLE POR BARBERO */}\n      <div className=\"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden\">\n        <div className=\"p-8 border-b border-slate-50 dark:border-slate-800 flex justify-between items-center\">\n          <h3 className=\"font-bold dark:text-white\">Rendimiento del Personal</h3>\n          <button className=\"flex items-center gap-2 text-xs font-bold text-blue-600 hover:bg-blue-50 p-2 px-4 rounded-xl transition-all\">\n            <Download size={16} /> Exportar\n          </button>\n        </div>\n        \n        <table className=\"w-full text-left border-collapse\">\n          <thead>\n            <tr className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] bg-slate-50/50 dark:bg-slate-800/50\">\n              <th className=\"px-8 py-4\">Barbero</th>\n              <th className=\"px-8 py-4\">Servicios</th>\n              <th className=\"px-8 py-4\">Bruto</th>\n              <th className=\"px-8 py-4\">Comisión (50%)</th>\n              <th className=\"px-8 py-4 text-right\">Neto Local</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-slate-50 dark:divide-slate-800\">\n            {stats.map((barber) => (\n              <tr key={barber.id} className=\"hover:bg-slate-50/50 dark:hover:bg-slate-800/30 transition-colors\">\n                <td className=\"px-8 py-5\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"size-10 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-blue-600 font-bold\">\n                      {barber.name.charAt(0)}\n                    </div>\n                    <span className=\"font-bold dark:text-white text-sm\">{barber.name}</span>\n                  </div>\n                </td>\n                <td className=\"px-8 py-5\">\n                  <span className=\"text-sm font-medium text-slate-600 dark:text-slate-400\">{barber.services} cortes</span>\n                </td>\n                <td className=\"px-8 py-5\">\n                  <span className=\"text-sm font-black dark:text-white\">${barber.total}</span>\n                </td>\n                <td className=\"px-8 py-5\">\n                  <span className=\"text-sm font-bold text-orange-500\">${barber.commission}</span>\n                </td>\n                <td className=\"px-8 py-5 text-right\">\n                  <span className=\"text-sm font-black text-emerald-500\">${barber.total - barber.commission}</span>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* GRÁFICO SIMPLE (SIMULADO CON BARRAS) */}\n      <div className=\"mt-8 bg-white dark:bg-slate-900 p-8 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm\">\n        <h3 className=\"font-bold mb-8 dark:text-white\">Flujo de Ingresos ({view})</h3>\n        <div className=\"flex items-end gap-4 h-48\">\n          {[40, 70, 45, 90, 65, 80, 50].map((h, i) => (\n            <div key={i} className=\"flex-1 flex flex-col items-center gap-2\">\n              <div \n                className=\"w-full bg-blue-600/10 hover:bg-blue-600 rounded-t-xl transition-all cursor-pointer\"\n                style={{ height: `${h}%` }}\n              />\n              <span className=\"text-[9px] font-bold text-slate-400 uppercase\">Día {i+1}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}"
        }
    ]
}