{
    "sourceFile": "app/reserva/[id]/page.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1767033797055,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1767033975296,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,356 +3,220 @@\n import React, { useState, useEffect } from \"react\";\n import { useParams } from \"next/navigation\";\n import { db } from \"@/services/firebase\";\n import { doc, getDoc, updateDoc, arrayUnion } from \"firebase/firestore\";\n-import {\n+import { \n+  Scissors, \n+  CheckCircle2, \n+  Loader2, \n+  Calendar, \n+  MapPin, \n+  ChevronLeft,\n   Clock,\n-  User,\n-  Scissors,\n-  CheckCircle2,\n-  Loader2,\n-  Calendar,\n-  MapPin,\n-  ChevronLeft,\n+  User\n } from \"lucide-react\";\n \n export default function PublicBookingPage() {\n   const { id } = useParams();\n   const [barberia, setBarberia] = useState(null);\n   const [loading, setLoading] = useState(true);\n-  const [step, setStep] = useState(1); // 1: Selecci√≥n de Staff, 2: Formulario, 3: √âxito\n+  const [step, setStep] = useState(1);\n   const [isSubmitting, setIsSubmitting] = useState(false);\n-\n+  const [availableSlots, setAvailableSlots] = useState([]);\n+  \n   const [booking, setBooking] = useState({\n     customer: \"\",\n     phone: \"\",\n     barber: \"\",\n     start: \"\",\n-    service: \"Corte General\",\n+    service: \"Corte General\"\n   });\n \n-  // --- 1. CARGAR DATOS DE LA BARBER√çA ---\n+  // 1. Cargar datos y generar horas\n   useEffect(() => {\n     const fetchBarberia = async () => {\n       if (!id) return;\n       try {\n         const docRef = doc(db, \"barberias\", id);\n         const docSnap = await getDoc(docRef);\n         if (docSnap.exists()) {\n-          setBarberia(docSnap.data());\n+          const data = docSnap.data();\n+          setBarberia(data);\n         }\n       } catch (error) {\n-        console.error(\"Error al cargar la barber√≠a:\", error);\n+        console.error(error);\n       } finally {\n         setLoading(false);\n       }\n     };\n     fetchBarberia();\n   }, [id]);\n \n-  // --- 2. PROCESAR RESERVA ---\n+  // 2. L√≥gica de disponibilidad de horas\n+  useEffect(() => {\n+    if (step === 2 && barberia) {\n+      generateAvailableSlots();\n+    }\n+  }, [step, booking.barber]);\n+\n+  const generateAvailableSlots = () => {\n+    // Definimos rango (esto podr√≠a venir de barberia.config si lo tienes)\n+    const startHour = 9; \n+    const endHour = 20;\n+    const interval = 30; // minutos entre turnos\n+    \n+    let slots = [];\n+    let current = new Date();\n+    current.setHours(startHour, 0, 0);\n+\n+    const end = new Date();\n+    end.setHours(endHour, 0, 0);\n+\n+    // Obtener horas ya ocupadas hoy para el barbero seleccionado\n+    const occupiedTimes = barberia.appointments\n+      ?.filter(app => app.barber === booking.barber && app.status !== 'cancelled')\n+      .map(app => app.start) || [];\n+\n+    while (current < end) {\n+      const timeString = current.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });\n+      \n+      // Solo agregar si no est√° ocupada\n+      if (!occupiedTimes.includes(timeString)) {\n+        slots.push(timeString);\n+      }\n+      current.setMinutes(current.getMinutes() + interval);\n+    }\n+    setAvailableSlots(slots);\n+  };\n+\n   const handleConfirm = async (e) => {\n     e.preventDefault();\n-    if (!booking.start || !booking.customer || !booking.phone) {\n-      alert(\"Por favor completa todos los campos.\");\n-      return;\n-    }\n-\n+    if (!booking.start) return alert(\"Selecciona una hora\");\n+    \n     setIsSubmitting(true);\n     try {\n       const barberiaRef = doc(db, \"barberias\", id);\n-\n       const newAppointment = {\n+        ...booking,\n         id: Date.now(),\n-        customer: booking.customer,\n-        phone: booking.phone,\n-        barber: booking.barber,\n-        service: booking.service,\n-        start: booking.start,\n         status: \"pending\",\n-        day: new Date().getDay() === 0 ? 6 : new Date().getDay() - 1,\n-        createdAt: new Date().toISOString(),\n+        createdAt: new Date().toISOString()\n       };\n \n-      // Guardar en Firebase\n       await updateDoc(barberiaRef, {\n-        appointments: arrayUnion(newAppointment),\n+        appointments: arrayUnion(newAppointment)\n       });\n \n       setStep(3);\n \n-      // Redirecci√≥n a WhatsApp para notificar al barbero\n+      // Notificaci√≥n WhatsApp\n       const cleanPhone = barberia.telefono?.replace(/\\D/g, \"\");\n       if (cleanPhone) {\n-        const msg = encodeURIComponent(\n-          `¬°Hola! Acabo de agendar un turno online:\\n\\n` +\n-            `üë§ Cliente: ${booking.customer}\\n` +\n-            `‚úÇÔ∏è Servicio: ${booking.service}\\n` +\n-            `üßî Barbero: ${booking.barber}\\n` +\n-            `‚è∞ Hora: ${booking.start}hs\\n\\n` +\n-            `¬°Nos vemos pronto!`\n-        );\n-\n-        setTimeout(() => {\n-          window.open(`https://wa.me/${cleanPhone}?text=${msg}`, \"_blank\");\n-        }, 2000);\n+        const msg = encodeURIComponent(`Nuevo Turno: ${booking.customer} - ${booking.service} con ${booking.barber} a las ${booking.start}hs`);\n+        setTimeout(() => window.open(`https://wa.me/${cleanPhone}?text=${msg}`, \"_blank\"), 1500);\n       }\n-    } catch (error) {\n-      console.error(\"Error al agendar:\", error);\n-      alert(\"Hubo un problema al guardar tu reserva. Int√©ntalo de nuevo.\");\n+    } catch (e) {\n+      alert(\"Error al reservar.\");\n     } finally {\n       setIsSubmitting(false);\n     }\n   };\n \n-  if (loading) {\n-    return (\n-      <div className=\"h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950\">\n-        <Loader2 className=\"animate-spin text-blue-600 mb-4\" size={40} />\n-        <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">\n-          Cargando agenda...\n-        </p>\n-      </div>\n-    );\n-  }\n+  if (loading) return <div className=\"h-screen flex items-center justify-center bg-slate-950\"><Loader2 className=\"animate-spin text-blue-600\" /></div>;\n \n-  if (!barberia) {\n-    return (\n-      <div className=\"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950 p-6 text-center\">\n-        <div>\n-          <h1 className=\"text-2xl font-black uppercase text-slate-300\">\n-            Agenda no disponible\n-          </h1>\n-          <p className=\"text-xs font-bold text-slate-400 mt-2 uppercase\">\n-            El link es incorrecto o la barber√≠a ya no acepta reservas online.\n-          </p>\n-        </div>\n-      </div>\n-    );\n-  }\n-\n   return (\n-    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 font-sans pb-20 transition-colors\">\n-      <div className=\"max-w-xl mx-auto px-4 pt-10\">\n-        {/* HEADER DE LA BARBER√çA */}\n-        <div className=\"text-center mb-10\">\n-          <div className=\"size-20 bg-slate-900 dark:bg-blue-600 rounded-[2rem] mx-auto mb-6 flex items-center justify-center text-white shadow-2xl shadow-blue-500/20\">\n-            <Scissors size={32} />\n-          </div>\n-          <h1 className=\"text-3xl font-black uppercase tracking-tighter dark:text-white leading-none\">\n-            {barberia.businessName}\n-          </h1>\n-          <div className=\"flex items-center justify-center gap-2 mt-4 text-slate-400\">\n-            <MapPin size={14} />\n-            <p className=\"text-[10px] font-bold uppercase tracking-widest\">\n-              {barberia.direccion || \"Ubicaci√≥n no especificada\"}\n-            </p>\n-          </div>\n-        </div>\n-\n+    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 p-4 md:p-8\">\n+      <div className=\"max-w-xl mx-auto\">\n+        \n         {/* PASO 1: SELECCI√ìN DE BARBERO */}\n         {step === 1 && (\n-          <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n-            <div className=\"text-center\">\n-              <span className=\"bg-blue-100 dark:bg-blue-500/10 text-blue-600 px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest\">\n-                Paso 1: Elige Profesional\n-              </span>\n+          <div className=\"animate-in fade-in zoom-in-95 duration-300\">\n+            <div className=\"text-center mb-10\">\n+              <h1 className=\"text-3xl font-black uppercase tracking-tighter dark:text-white\">{barberia.businessName}</h1>\n+              <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-2 text-blue-600\">Elige tu barbero</p>\n             </div>\n             <div className=\"grid gap-3\">\n-              {barberia.barbers && barberia.barbers.length > 0 ? (\n-                barberia.barbers.map((b, idx) => (\n-                  <button\n-                    key={idx}\n-                    onClick={() => {\n-                      setBooking({ ...booking, barber: b.name });\n-                      setStep(2);\n-                    }}\n-                    className=\"group flex items-center gap-4 p-5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-[2rem] hover:border-blue-600 transition-all text-left shadow-sm active:scale-95\"\n-                  >\n-                    <div className=\"size-16 rounded-2xl bg-slate-100 dark:bg-slate-800 overflow-hidden flex items-center justify-center border border-slate-200 dark:border-slate-700\">\n-                      {b.imageUrl ? (\n-                        <img\n-                          src={b.imageUrl}\n-                          alt={b.name}\n-                          className=\"size-full object-cover\"\n-                        />\n-                      ) : (\n-                        <User className=\"text-slate-400\" size={24} />\n-                      )}\n-                    </div>\n-                    <div className=\"flex-1\">\n-                      <p className=\"font-black uppercase text-sm dark:text-white group-hover:text-blue-600 transition-colors\">\n-                        {b.name}\n-                      </p>\n-                      <p className=\"text-[9px] font-black text-emerald-500 uppercase tracking-widest mt-1 flex items-center gap-1\">\n-                        <span className=\"size-1.5 bg-emerald-500 rounded-full animate-pulse\" />{\" \"}\n-                        Disponible Hoy\n-                      </p>\n-                    </div>\n-                  </button>\n-                ))\n-              ) : (\n-                <p className=\"text-center py-10 text-slate-400 font-bold uppercase text-xs\">\n-                  No hay profesionales disponibles en este momento.\n-                </p>\n-              )}\n+              {barberia.barbers?.map((b, idx) => (\n+                <button \n+                  key={idx} \n+                  onClick={() => { setBooking({...booking, barber: b.name}); setStep(2); }}\n+                  className=\"flex items-center gap-4 p-5 bg-white dark:bg-slate-900 rounded-[2rem] border border-slate-200 dark:border-slate-800 hover:border-blue-600 transition-all shadow-sm\"\n+                >\n+                  <div className=\"size-14 bg-slate-100 dark:bg-slate-800 rounded-2xl flex items-center justify-center font-black text-slate-400\">\n+                    {b.name[0]}\n+                  </div>\n+                  <div className=\"text-left\">\n+                    <p className=\"font-black uppercase text-sm dark:text-white\">{b.name}</p>\n+                    <p className=\"text-[9px] font-bold text-emerald-500 uppercase\">Disponible</p>\n+                  </div>\n+                </button>\n+              ))}\n             </div>\n           </div>\n         )}\n \n-        {/* PASO 2: FORMULARIO DE RESERVA */}\n+        {/* PASO 2: FORMULARIO Y HORAS DISPONIBLES */}\n         {step === 2 && (\n-          <form\n-            onSubmit={handleConfirm}\n-            className=\"animate-in fade-in slide-in-from-right-4 duration-500 bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 border border-slate-200 dark:border-slate-800 shadow-2xl space-y-5\"\n-          >\n-            <div className=\"flex items-center justify-between mb-4\">\n-              <button\n-                type=\"button\"\n-                onClick={() => setStep(1)}\n-                className=\"size-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-xl text-slate-500 hover:text-blue-600 transition-colors\"\n-              >\n-                <ChevronLeft size={20} />\n-              </button>\n-              <h3 className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest\">\n-                Detalles del Turno\n-              </h3>\n-              <div className=\"size-10\" /> {/* Spacer */}\n-            </div>\n+          <form onSubmit={handleConfirm} className=\"animate-in slide-in-from-right-8 duration-300 space-y-6\">\n+            <button onClick={() => setStep(1)} className=\"flex items-center gap-2 text-[10px] font-black uppercase text-slate-400\">\n+              <ChevronLeft size={16}/> Volver\n+            </button>\n \n-            <div className=\"space-y-4\">\n-              <div className=\"space-y-1.5\">\n-                <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">\n-                  Nombre Completo\n-                </label>\n-                <input\n-                  required\n-                  type=\"text\"\n-                  placeholder=\"Ej. Juan P√©rez\"\n-                  className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                  onChange={(e) =>\n-                    setBooking({ ...booking, customer: e.target.value })\n-                  }\n-                />\n-              </div>\n+            <div className=\"bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 border border-slate-200 dark:border-slate-800 shadow-xl space-y-4\">\n+              <input required placeholder=\"Tu Nombre\" className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\" \n+                onChange={e => setBooking({...booking, customer: e.target.value})} />\n+              \n+              <input required type=\"tel\" placeholder=\"WhatsApp\" className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n+                onChange={e => setBooking({...booking, phone: e.target.value})} />\n \n-              <div className=\"space-y-1.5\">\n-                <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">\n-                  WhatsApp\n-                </label>\n-                <input\n-                  required\n-                  type=\"tel\"\n-                  placeholder=\"Tu celular para avisarte\"\n-                  className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                  onChange={(e) =>\n-                    setBooking({ ...booking, phone: e.target.value })\n-                  }\n-                />\n-              </div>\n+              <select className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white appearance-none\"\n+                onChange={e => setBooking({...booking, service: e.target.value})}>\n+                <option>Corte General</option>\n+                <option>Barba</option>\n+                <option>Corte + Barba</option>\n+              </select>\n \n-              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n-                <div className=\"space-y-1.5\">\n-                  <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">\n-                    Hora\n-                  </label>\n-                  <input\n-                    required\n-                    type=\"time\"\n-                    className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                    onChange={(e) =>\n-                      setBooking({ ...booking, start: e.target.value })\n-                    }\n-                  />\n-                </div>\n-                <div className=\"space-y-1.5\">\n-                  <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">\n-                    Servicio\n-                  </label>\n-                  <div className=\"relative\">\n-                    <select\n-                      className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white appearance-none outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                      onChange={(e) =>\n-                        setBooking({ ...booking, service: e.target.value })\n-                      }\n+              <div className=\"pt-4\">\n+                <p className=\"text-[10px] font-black uppercase text-slate-400 mb-4 ml-2 tracking-widest flex items-center gap-2\">\n+                  <Clock size={12}/> Horas Disponibles para {booking.barber}\n+                </p>\n+                <div className=\"grid grid-cols-3 gap-2\">\n+                  {availableSlots.length > 0 ? availableSlots.map(time => (\n+                    <button\n+                      key={time}\n+                      type=\"button\"\n+                      onClick={() => setBooking({...booking, start: time})}\n+                      className={`py-3 rounded-xl font-black text-xs transition-all ${\n+                        booking.start === time \n+                        ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/30 scale-95' \n+                        : 'bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700'\n+                      }`}\n                     >\n-                      <option value=\"Corte General\">Corte General</option>\n-                      <option value=\"Corte y Barba\">Corte y Barba</option>\n-                      <option value=\"Perfilado de Barba\">\n-                        Perfilado de Barba\n-                      </option>\n-                      <option value=\"Corte Kids\">Corte Kids</option>\n-                      <option value=\"Color / Reflejos\">Color / Reflejos</option>\n-                    </select>\n-                  </div>\n+                      {time}\n+                    </button>\n+                  )) : (\n+                    <p className=\"col-span-3 text-center text-[10px] font-bold text-red-500 uppercase\">No hay m√°s turnos hoy</p>\n+                  )}\n                 </div>\n               </div>\n+\n+              <button disabled={isSubmitting || !booking.start} type=\"submit\" className=\"w-full bg-blue-600 text-white font-black uppercase py-5 rounded-2xl shadow-xl shadow-blue-500/30 hover:bg-blue-700 transition-all mt-6 disabled:opacity-50 text-xs tracking-widest\">\n+                {isSubmitting ? \"Agendando...\" : \"Confirmar Turno\"}\n+              </button>\n             </div>\n-\n-            <button\n-              type=\"submit\"\n-              disabled={isSubmitting}\n-              className=\"w-full bg-blue-600 text-white font-black uppercase py-5 rounded-2xl shadow-xl shadow-blue-500/30 hover:bg-blue-700 transition-all mt-6 tracking-widest text-xs flex items-center justify-center gap-2 disabled:opacity-50\"\n-            >\n-              {isSubmitting ? (\n-                <>\n-                  <Loader2 className=\"animate-spin\" size={16} /> Procesando...\n-                </>\n-              ) : (\n-                \"Confirmar Mi Turno\"\n-              )}\n-            </button>\n-            <p className=\"text-[8px] font-black text-slate-400 text-center uppercase tracking-tighter\">\n-              Al confirmar, te redirigiremos a WhatsApp para notificar a la\n-              barber√≠a.\n-            </p>\n           </form>\n         )}\n \n         {/* PASO 3: √âXITO */}\n         {step === 3 && (\n-          <div className=\"text-center p-10 bg-white dark:bg-slate-900 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-2xl animate-in zoom-in-95 duration-500\">\n-            <div className=\"size-20 bg-emerald-500 text-white rounded-full flex items-center justify-center mx-auto mb-8 shadow-lg shadow-emerald-500/20\">\n-              <CheckCircle2 size={40} />\n-            </div>\n-            <h2 className=\"text-3xl font-black uppercase dark:text-white tracking-tighter leading-tight\">\n-              ¬°Turno Confirmado!\n-            </h2>\n-            <p className=\"text-slate-500 font-bold text-sm mt-4 uppercase\">\n-              Agendado con{\" \"}\n-              <span className=\"text-blue-600\">{booking.barber}</span> a las{\" \"}\n-              <span className=\"text-blue-600\">{booking.start}hs</span>.\n-            </p>\n-\n-            <div className=\"mt-8 p-6 bg-slate-50 dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700\">\n-              <div className=\"flex flex-col items-center gap-2\">\n-                <MapPin size={18} className=\"text-blue-600\" />\n-                <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">\n-                  Te esperamos en:\n-                </p>\n-                <p className=\"font-black text-xs dark:text-white uppercase text-center\">\n-                  {barberia.direccion}\n-                </p>\n-              </div>\n-            </div>\n-\n-            <div className=\"mt-10 space-y-3\">\n-              <div className=\"flex items-center justify-center gap-2 text-blue-500 animate-pulse\">\n-                <Loader2 size={14} className=\"animate-spin\" />\n-                <p className=\"text-[9px] font-black uppercase tracking-widest\">\n-                  Abriendo WhatsApp...\n-                </p>\n-              </div>\n-            </div>\n+          <div className=\"text-center p-12 bg-white dark:bg-slate-900 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-2xl\">\n+            <CheckCircle2 size={60} className=\"text-emerald-500 mx-auto mb-6\" />\n+            <h2 className=\"text-2xl font-black uppercase dark:text-white tracking-tighter\">¬°Listo, {booking.customer}!</h2>\n+            <p className=\"text-slate-500 font-bold text-sm mt-4 uppercase\">Turno confirmado a las <span className=\"text-blue-600\">{booking.start}hs</span></p>\n+            <p className=\"text-[9px] font-black text-slate-400 uppercase mt-8 tracking-widest\">Abriendo WhatsApp...</p>\n           </div>\n         )}\n \n-        {/* FOOTER */}\n-        <div className=\"mt-12 text-center\">\n-          <p className=\"text-[8px] font-black uppercase tracking-widest text-slate-400\">\n-            Power by <span className=\"text-blue-600\">BarberPro</span> System\n-          </p>\n-        </div>\n       </div>\n     </div>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1767040766211,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,16 +4,18 @@\n import { useParams } from \"next/navigation\";\n import { db } from \"@/services/firebase\";\n import { doc, getDoc, updateDoc, arrayUnion } from \"firebase/firestore\";\n import {\n-  Scissors,\n   CheckCircle2,\n   Loader2,\n   Calendar,\n   MapPin,\n   ChevronLeft,\n   Clock,\n   User,\n+  Scissors,\n+  Smartphone,\n+  Info\n } from \"lucide-react\";\n \n export default function PublicBookingPage() {\n   const { id } = useParams();\n@@ -30,18 +32,16 @@\n     start: \"\",\n     service: \"Corte General\",\n   });\n \n-  // 1. Cargar datos y generar horas\n   useEffect(() => {\n     const fetchBarberia = async () => {\n       if (!id) return;\n       try {\n         const docRef = doc(db, \"barberias\", id);\n         const docSnap = await getDoc(docRef);\n         if (docSnap.exists()) {\n-          const data = docSnap.data();\n-          setBarberia(data);\n+          setBarberia(docSnap.data());\n         }\n       } catch (error) {\n         console.error(error);\n       } finally {\n@@ -50,44 +50,30 @@\n     };\n     fetchBarberia();\n   }, [id]);\n \n-  // 2. L√≥gica de disponibilidad de horas\n   useEffect(() => {\n     if (step === 2 && barberia) {\n       generateAvailableSlots();\n     }\n   }, [step, booking.barber]);\n \n   const generateAvailableSlots = () => {\n-    // Definimos rango (esto podr√≠a venir de barberia.config si lo tienes)\n     const startHour = 9;\n     const endHour = 20;\n-    const interval = 30; // minutos entre turnos\n-\n+    const interval = 30;\n     let slots = [];\n     let current = new Date();\n     current.setHours(startHour, 0, 0);\n-\n     const end = new Date();\n     end.setHours(endHour, 0, 0);\n \n-    // Obtener horas ya ocupadas hoy para el barbero seleccionado\n-    const occupiedTimes =\n-      barberia.appointments\n-        ?.filter(\n-          (app) => app.barber === booking.barber && app.status !== \"cancelled\"\n-        )\n-        .map((app) => app.start) || [];\n+    const occupiedTimes = barberia.appointments\n+      ?.filter(app => app.barber === booking.barber && app.status !== \"cancelled\")\n+      .map(app => app.start) || [];\n \n     while (current < end) {\n-      const timeString = current.toLocaleTimeString([], {\n-        hour: \"2-digit\",\n-        minute: \"2-digit\",\n-        hour12: false,\n-      });\n-\n-      // Solo agregar si no est√° ocupada\n+      const timeString = current.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\", hour12: false });\n       if (!occupiedTimes.includes(timeString)) {\n         slots.push(timeString);\n       }\n       current.setMinutes(current.getMinutes() + interval);\n@@ -97,191 +83,189 @@\n \n   const handleConfirm = async (e) => {\n     e.preventDefault();\n     if (!booking.start) return alert(\"Selecciona una hora\");\n-\n     setIsSubmitting(true);\n     try {\n       const barberiaRef = doc(db, \"barberias\", id);\n-      const newAppointment = {\n-        ...booking,\n-        id: Date.now(),\n-        status: \"pending\",\n-        createdAt: new Date().toISOString(),\n-      };\n-\n-      await updateDoc(barberiaRef, {\n-        appointments: arrayUnion(newAppointment),\n-      });\n-\n+      const newAppointment = { ...booking, id: Date.now(), status: \"pending\", createdAt: new Date().toISOString() };\n+      await updateDoc(barberiaRef, { appointments: arrayUnion(newAppointment) });\n       setStep(3);\n-\n-      // Notificaci√≥n WhatsApp\n       const cleanPhone = barberia.telefono?.replace(/\\D/g, \"\");\n       if (cleanPhone) {\n-        const msg = encodeURIComponent(\n-          `Nuevo Turno: ${booking.customer} - ${booking.service} con ${booking.barber} a las ${booking.start}hs`\n-        );\n-        setTimeout(\n-          () =>\n-            window.open(`https://wa.me/${cleanPhone}?text=${msg}`, \"_blank\"),\n-          1500\n-        );\n+        const msg = encodeURIComponent(`¬°Hola! Reserv√© un turno:\\nüë§ *Nombre:* ${booking.customer}\\n‚úÇÔ∏è *Servicio:* ${booking.service}\\nüíà *Barbero:* ${booking.barber}\\n‚è∞ *Hora:* ${booking.start}hs`);\n+        setTimeout(() => window.open(`https://wa.me/${cleanPhone}?text=${msg}`, \"_blank\"), 1500);\n       }\n     } catch (e) {\n       alert(\"Error al reservar.\");\n     } finally {\n       setIsSubmitting(false);\n     }\n   };\n \n-  if (loading)\n-    return (\n-      <div className=\"h-screen flex items-center justify-center bg-slate-950\">\n-        <Loader2 className=\"animate-spin text-blue-600\" />\n+  if (loading) return (\n+    <div className=\"h-screen flex items-center justify-center bg-white dark:bg-slate-950\">\n+      <div className=\"flex flex-col items-center gap-4\">\n+        <Loader2 className=\"animate-spin text-blue-600\" size={40} />\n+        <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">Preparando Agenda...</p>\n       </div>\n-    );\n+    </div>\n+  );\n \n   return (\n-    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 p-4 md:p-8\">\n-      <div className=\"max-w-xl mx-auto\">\n+    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 font-sans selection:bg-blue-100 selection:text-blue-900\">\n+      \n+      {/* HEADER DE LA BARBER√çA */}\n+      <div className=\"bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 pt-12 pb-8 px-6 text-center shadow-sm\">\n+        <div className=\"max-w-xl mx-auto flex flex-col items-center\">\n+          <div className=\"size-24 rounded-[2rem] bg-slate-100 dark:bg-slate-800 border-4 border-white dark:border-slate-700 shadow-2xl overflow-hidden mb-6 group transition-transform hover:scale-105\">\n+            {barberia?.logo ? (\n+              <img src={barberia.logo} alt=\"Logo\" className=\"w-full h-full object-cover\" />\n+            ) : (\n+              <div className=\"w-full h-full flex items-center justify-center text-blue-600\">\n+                <Scissors size={32} />\n+              </div>\n+            )}\n+          </div>\n+          <h1 className=\"text-3xl font-black uppercase tracking-tighter dark:text-white italic\">{barberia?.businessName}</h1>\n+          <div className=\"flex items-center gap-4 mt-3\">\n+             <p className=\"flex items-center gap-1.5 text-[10px] font-black text-slate-400 uppercase tracking-widest\">\n+               <MapPin size={12} className=\"text-blue-600\" /> {barberia?.direccion || \"Uruguay\"}\n+             </p>\n+          </div>\n+        </div>\n+      </div>\n+\n+      <div className=\"max-w-xl mx-auto p-6 -mt-4\">\n+        \n         {/* PASO 1: SELECCI√ìN DE BARBERO */}\n         {step === 1 && (\n-          <div className=\"animate-in fade-in zoom-in-95 duration-300\">\n-            <div className=\"text-center mb-10\">\n-              <h1 className=\"text-3xl font-black uppercase tracking-tighter dark:text-white\">\n-                {barberia.businessName}\n-              </h1>\n-              <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mt-2 text-blue-600\">\n-                Elige tu barbero\n-              </p>\n+          <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n+            <div className=\"flex items-center justify-between px-2\">\n+               <h3 className=\"text-xs font-black uppercase text-slate-400 tracking-[0.2em]\">Selecciona Profesional</h3>\n+               <span className=\"bg-blue-600 text-white text-[9px] font-black px-3 py-1 rounded-full uppercase\">Paso 1/2</span>\n             </div>\n-            <div className=\"grid gap-3\">\n-              {barberia.barbers?.map((b, idx) => (\n-                <button\n-                  key={idx}\n-                  onClick={() => {\n-                    setBooking({ ...booking, barber: b.name });\n-                    setStep(2);\n-                  }}\n-                  className=\"flex items-center gap-4 p-5 bg-white dark:bg-slate-900 rounded-[2rem] border border-slate-200 dark:border-slate-800 hover:border-blue-600 transition-all shadow-sm\"\n-                >\n-                  <div className=\"size-14 bg-slate-100 dark:bg-slate-800 rounded-2xl flex items-center justify-center font-black text-slate-400\">\n-                    {b.name[0]}\n-                  </div>\n-                  <div className=\"text-left\">\n-                    <p className=\"font-black uppercase text-sm dark:text-white\">\n-                      {b.name}\n-                    </p>\n-                    <p className=\"text-[9px] font-bold text-emerald-500 uppercase\">\n-                      Disponible\n-                    </p>\n-                  </div>\n-                </button>\n-              ))}\n+            \n+            <div className=\"grid gap-4\">\n+              {barberia?.barbers?.length > 0 ? (\n+                barberia.barbers.map((b, idx) => (\n+                  <button\n+                    key={idx}\n+                    onClick={() => { setBooking({ ...booking, barber: b.name }); setStep(2); }}\n+                    className=\"group flex items-center gap-5 p-6 bg-white dark:bg-slate-900 rounded-[2.5rem] border-2 border-transparent hover:border-blue-600 transition-all shadow-xl shadow-slate-200/50 dark:shadow-none\"\n+                  >\n+                    <div className=\"size-16 bg-blue-50 dark:bg-slate-800 rounded-3xl flex items-center justify-center font-black text-xl text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors uppercase\">\n+                      {b.name[0]}\n+                    </div>\n+                    <div className=\"text-left flex-1\">\n+                      <p className=\"font-black uppercase text-base dark:text-white tracking-tight\">{b.name}</p>\n+                      <p className=\"text-[10px] font-bold text-emerald-500 uppercase flex items-center gap-1\">\n+                        <div className=\"size-1.5 rounded-full bg-emerald-500 animate-pulse\" /> Disponible Hoy\n+                      </p>\n+                    </div>\n+                    <ChevronLeft size={20} className=\"rotate-180 text-slate-300 group-hover:text-blue-600\" />\n+                  </button>\n+                ))\n+              ) : (\n+                <div className=\"text-center p-10 bg-white dark:bg-slate-900 rounded-3xl border border-dashed border-slate-300\">\n+                  <p className=\"text-xs font-bold text-slate-400 uppercase\">No hay barberos registrados</p>\n+                </div>\n+              )}\n             </div>\n           </div>\n         )}\n \n-        {/* PASO 2: FORMULARIO Y HORAS DISPONIBLES */}\n+        {/* PASO 2: FORMULARIO Y HORAS */}\n         {step === 2 && (\n-          <form\n-            onSubmit={handleConfirm}\n-            className=\"animate-in slide-in-from-right-8 duration-300 space-y-6\"\n-          >\n-            <button\n-              onClick={() => setStep(1)}\n-              className=\"flex items-center gap-2 text-[10px] font-black uppercase text-slate-400\"\n-            >\n-              <ChevronLeft size={16} /> Volver\n+          <form onSubmit={handleConfirm} className=\"space-y-6 animate-in slide-in-from-right-8 duration-500 pb-20\">\n+            <button onClick={() => setStep(1)} className=\"flex items-center gap-2 text-[10px] font-black uppercase text-blue-600 bg-blue-50 dark:bg-blue-900/20 px-4 py-2 rounded-full\">\n+              <ChevronLeft size={14} /> Cambiar Barbero\n             </button>\n \n-            <div className=\"bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 border border-slate-200 dark:border-slate-800 shadow-xl space-y-4\">\n-              <input\n-                required\n-                placeholder=\"Tu Nombre\"\n-                className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                onChange={(e) =>\n-                  setBooking({ ...booking, customer: e.target.value })\n-                }\n-              />\n+            <div className=\"bg-white dark:bg-slate-900 rounded-[3rem] p-8 border border-slate-200 dark:border-slate-800 shadow-2xl space-y-8\">\n+              \n+              <div className=\"space-y-4\">\n+                <div className=\"relative\">\n+                  <User className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n+                  <input required placeholder=\"TU NOMBRE COMPLETO\" className=\"w-full bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-600 rounded-2xl pl-14 pr-6 py-5 font-black uppercase text-xs dark:text-white outline-none transition-all\"\n+                    onChange={(e) => setBooking({ ...booking, customer: e.target.value })} />\n+                </div>\n \n-              <input\n-                required\n-                type=\"tel\"\n-                placeholder=\"WhatsApp\"\n-                className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n-                onChange={(e) =>\n-                  setBooking({ ...booking, phone: e.target.value })\n-                }\n-              />\n+                <div className=\"relative\">\n+                  <Smartphone className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n+                  <input required type=\"tel\" placeholder=\"WHATSAPP (SIN EL 0)\" className=\"w-full bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-600 rounded-2xl pl-14 pr-6 py-5 font-black uppercase text-xs dark:text-white outline-none transition-all\"\n+                    onChange={(e) => setBooking({ ...booking, phone: e.target.value })} />\n+                </div>\n \n-              <select\n-                className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white appearance-none\"\n-                onChange={(e) =>\n-                  setBooking({ ...booking, service: e.target.value })\n-                }\n-              >\n-                <option>Corte General</option>\n-                <option>Barba</option>\n-                <option>Corte + Barba</option>\n-              </select>\n+                <div className=\"relative\">\n+                  <Scissors className=\"absolute left-5 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\n+                  <select className=\"w-full bg-slate-50 dark:bg-slate-800 border-2 border-transparent focus:border-blue-600 rounded-2xl pl-14 pr-6 py-5 font-black uppercase text-xs dark:text-white outline-none appearance-none cursor-pointer\"\n+                    onChange={(e) => setBooking({ ...booking, service: e.target.value })}>\n+                    <option>Corte General</option>\n+                    <option>Corte + Barba</option>\n+                    <option>Barba</option>\n+                    <option>Corte Ni√±o</option>\n+                  </select>\n+                </div>\n+              </div>\n \n-              <div className=\"pt-4\">\n-                <p className=\"text-[10px] font-black uppercase text-slate-400 mb-4 ml-2 tracking-widest flex items-center gap-2\">\n-                  <Clock size={12} /> Horas Disponibles para {booking.barber}\n-                </p>\n-                <div className=\"grid grid-cols-3 gap-2\">\n+              <div className=\"space-y-4\">\n+                <div className=\"flex items-center justify-between px-2\">\n+                  <p className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest flex items-center gap-2\">\n+                    <Clock size={14} className=\"text-blue-600\" /> Horarios con {booking.barber}\n+                  </p>\n+                </div>\n+                \n+                <div className=\"grid grid-cols-3 sm:grid-cols-4 gap-2\">\n                   {availableSlots.length > 0 ? (\n                     availableSlots.map((time) => (\n-                      <button\n-                        key={time}\n-                        type=\"button\"\n-                        onClick={() => setBooking({ ...booking, start: time })}\n-                        className={`py-3 rounded-xl font-black text-xs transition-all ${\n+                      <button key={time} type=\"button\" onClick={() => setBooking({ ...booking, start: time })}\n+                        className={`py-4 rounded-2xl font-black text-xs transition-all border-2 ${\n                           booking.start === time\n-                            ? \"bg-blue-600 text-white shadow-lg shadow-blue-500/30 scale-95\"\n-                            : \"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700\"\n-                        }`}\n-                      >\n+                            ? \"bg-blue-600 text-white border-blue-600 shadow-lg shadow-blue-500/40 scale-95\"\n+                            : \"bg-white dark:bg-slate-800 border-slate-100 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:border-blue-600\"\n+                        }`}>\n                         {time}\n                       </button>\n                     ))\n                   ) : (\n-                    <p className=\"col-span-3 text-center text-[10px] font-bold text-red-500 uppercase\">\n-                      No hay m√°s turnos hoy\n-                    </p>\n+                    <div className=\"col-span-full p-6 bg-red-50 dark:bg-red-900/10 rounded-2xl border border-red-100 dark:border-red-900/30 text-center\">\n+                       <p className=\"text-[10px] font-black text-red-500 uppercase\">Sin turnos disponibles para hoy</p>\n+                    </div>\n                   )}\n                 </div>\n               </div>\n \n-              <button\n-                disabled={isSubmitting || !booking.start}\n-                type=\"submit\"\n-                className=\"w-full bg-blue-600 text-white font-black uppercase py-5 rounded-2xl shadow-xl shadow-blue-500/30 hover:bg-blue-700 transition-all mt-6 disabled:opacity-50 text-xs tracking-widest\"\n-              >\n-                {isSubmitting ? \"Agendando...\" : \"Confirmar Turno\"}\n+              <button disabled={isSubmitting || !booking.start} type=\"submit\"\n+                className=\"w-full bg-blue-600 text-white font-black uppercase py-6 rounded-[2rem] shadow-xl shadow-blue-500/30 hover:bg-blue-700 active:scale-95 transition-all disabled:opacity-50 text-[11px] tracking-[0.2em] flex items-center justify-center gap-3\">\n+                {isSubmitting ? <Loader2 className=\"animate-spin\" size={18} /> : \"Finalizar Reserva\"}\n               </button>\n             </div>\n           </form>\n         )}\n \n         {/* PASO 3: √âXITO */}\n         {step === 3 && (\n-          <div className=\"text-center p-12 bg-white dark:bg-slate-900 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-2xl\">\n-            <CheckCircle2 size={60} className=\"text-emerald-500 mx-auto mb-6\" />\n-            <h2 className=\"text-2xl font-black uppercase dark:text-white tracking-tighter\">\n-              ¬°Listo, {booking.customer}!\n-            </h2>\n-            <p className=\"text-slate-500 font-bold text-sm mt-4 uppercase\">\n-              Turno confirmado a las{\" \"}\n-              <span className=\"text-blue-600\">{booking.start}hs</span>\n+          <div className=\"animate-in zoom-in-95 duration-500 text-center py-16 px-8 bg-white dark:bg-slate-900 rounded-[4rem] border border-slate-200 dark:border-slate-800 shadow-2xl mt-10\">\n+            <div className=\"size-24 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto mb-8\">\n+               <CheckCircle2 size={48} className=\"text-emerald-500\" />\n+            </div>\n+            <h2 className=\"text-3xl font-black uppercase dark:text-white tracking-tighter italic\">¬°Reserva Exitosa!</h2>\n+            <p className=\"text-slate-500 font-bold text-sm mt-4 uppercase tracking-tight max-w-[250px] mx-auto\">\n+              Te esperamos a las <span className=\"text-blue-600 font-black\">{booking.start}hs</span> con {booking.barber}.\n             </p>\n-            <p className=\"text-[9px] font-black text-slate-400 uppercase mt-8 tracking-widest\">\n-              Abriendo WhatsApp...\n-            </p>\n+            \n+            <div className=\"mt-12 p-6 bg-slate-50 dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700\">\n+               <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2\">Siguiente Paso</p>\n+               <p className=\"text-[11px] font-bold dark:text-slate-300\">Se ha abierto WhatsApp para confirmar tu asistencia con el barbero.</p>\n+            </div>\n           </div>\n         )}\n       </div>\n+\n+      {/* FOOTER DISCRETO */}\n+      <div className=\"fixed bottom-6 w-full text-center pointer-events-none\">\n+         <p className=\"text-[8px] font-black text-slate-300 dark:text-slate-700 uppercase tracking-[0.4em]\">Powered by BarberManager</p>\n+      </div>\n     </div>\n   );\n-}\n+}\n\\ No newline at end of file\n"
                }
            ],
            "date": 1767033797055,
            "name": "Commit-0",
            "content": "\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { useParams } from \"next/navigation\";\nimport { db } from \"@/services/firebase\";\nimport { doc, getDoc, updateDoc, arrayUnion } from \"firebase/firestore\";\nimport { \n  Clock, \n  User, \n  Scissors, \n  CheckCircle2, \n  Loader2, \n  Calendar, \n  MapPin, \n  ChevronLeft \n} from \"lucide-react\";\n\nexport default function PublicBookingPage() {\n  const { id } = useParams();\n  const [barberia, setBarberia] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [step, setStep] = useState(1); // 1: Selecci√≥n de Staff, 2: Formulario, 3: √âxito\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  const [booking, setBooking] = useState({\n    customer: \"\",\n    phone: \"\",\n    barber: \"\",\n    start: \"\",\n    service: \"Corte General\"\n  });\n\n  // --- 1. CARGAR DATOS DE LA BARBER√çA ---\n  useEffect(() => {\n    const fetchBarberia = async () => {\n      if (!id) return;\n      try {\n        const docRef = doc(db, \"barberias\", id);\n        const docSnap = await getDoc(docRef);\n        if (docSnap.exists()) {\n          setBarberia(docSnap.data());\n        }\n      } catch (error) {\n        console.error(\"Error al cargar la barber√≠a:\", error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchBarberia();\n  }, [id]);\n\n  // --- 2. PROCESAR RESERVA ---\n  const handleConfirm = async (e) => {\n    e.preventDefault();\n    if (!booking.start || !booking.customer || !booking.phone) {\n      alert(\"Por favor completa todos los campos.\");\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      const barberiaRef = doc(db, \"barberias\", id);\n      \n      const newAppointment = {\n        id: Date.now(),\n        customer: booking.customer,\n        phone: booking.phone,\n        barber: booking.barber,\n        service: booking.service,\n        start: booking.start,\n        status: \"pending\",\n        day: new Date().getDay() === 0 ? 6 : new Date().getDay() - 1,\n        createdAt: new Date().toISOString()\n      };\n\n      // Guardar en Firebase\n      await updateDoc(barberiaRef, {\n        appointments: arrayUnion(newAppointment)\n      });\n\n      setStep(3);\n\n      // Redirecci√≥n a WhatsApp para notificar al barbero\n      const cleanPhone = barberia.telefono?.replace(/\\D/g, \"\");\n      if (cleanPhone) {\n        const msg = encodeURIComponent(\n          `¬°Hola! Acabo de agendar un turno online:\\n\\n` +\n          `üë§ Cliente: ${booking.customer}\\n` +\n          `‚úÇÔ∏è Servicio: ${booking.service}\\n` +\n          `üßî Barbero: ${booking.barber}\\n` +\n          `‚è∞ Hora: ${booking.start}hs\\n\\n` +\n          `¬°Nos vemos pronto!`\n        );\n        \n        setTimeout(() => {\n          window.open(`https://wa.me/${cleanPhone}?text=${msg}`, \"_blank\");\n        }, 2000);\n      }\n    } catch (error) {\n      console.error(\"Error al agendar:\", error);\n      alert(\"Hubo un problema al guardar tu reserva. Int√©ntalo de nuevo.\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950\">\n        <Loader2 className=\"animate-spin text-blue-600 mb-4\" size={40} />\n        <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400\">Cargando agenda...</p>\n      </div>\n    );\n  }\n\n  if (!barberia) {\n    return (\n      <div className=\"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950 p-6 text-center\">\n        <div>\n          <h1 className=\"text-2xl font-black uppercase text-slate-300\">Agenda no disponible</h1>\n          <p className=\"text-xs font-bold text-slate-400 mt-2 uppercase\">El link es incorrecto o la barber√≠a ya no acepta reservas online.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 font-sans pb-20 transition-colors\">\n      <div className=\"max-w-xl mx-auto px-4 pt-10\">\n        \n        {/* HEADER DE LA BARBER√çA */}\n        <div className=\"text-center mb-10\">\n          <div className=\"size-20 bg-slate-900 dark:bg-blue-600 rounded-[2rem] mx-auto mb-6 flex items-center justify-center text-white shadow-2xl shadow-blue-500/20\">\n            <Scissors size={32} />\n          </div>\n          <h1 className=\"text-3xl font-black uppercase tracking-tighter dark:text-white leading-none\">\n            {barberia.businessName}\n          </h1>\n          <div className=\"flex items-center justify-center gap-2 mt-4 text-slate-400\">\n            <MapPin size={14} />\n            <p className=\"text-[10px] font-bold uppercase tracking-widest\">{barberia.direccion || \"Ubicaci√≥n no especificada\"}</p>\n          </div>\n        </div>\n\n        {/* PASO 1: SELECCI√ìN DE BARBERO */}\n        {step === 1 && (\n          <div className=\"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500\">\n            <div className=\"text-center\">\n              <span className=\"bg-blue-100 dark:bg-blue-500/10 text-blue-600 px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest\">\n                Paso 1: Elige Profesional\n              </span>\n            </div>\n            <div className=\"grid gap-3\">\n              {barberia.barbers && barberia.barbers.length > 0 ? (\n                barberia.barbers.map((b, idx) => (\n                  <button \n                    key={idx}\n                    onClick={() => { setBooking({...booking, barber: b.name}); setStep(2); }}\n                    className=\"group flex items-center gap-4 p-5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-[2rem] hover:border-blue-600 transition-all text-left shadow-sm active:scale-95\"\n                  >\n                    <div className=\"size-16 rounded-2xl bg-slate-100 dark:bg-slate-800 overflow-hidden flex items-center justify-center border border-slate-200 dark:border-slate-700\">\n                      {b.imageUrl ? (\n                        <img src={b.imageUrl} alt={b.name} className=\"size-full object-cover\" />\n                      ) : (\n                        <User className=\"text-slate-400\" size={24} />\n                      )}\n                    </div>\n                    <div className=\"flex-1\">\n                      <p className=\"font-black uppercase text-sm dark:text-white group-hover:text-blue-600 transition-colors\">{b.name}</p>\n                      <p className=\"text-[9px] font-black text-emerald-500 uppercase tracking-widest mt-1 flex items-center gap-1\">\n                        <span className=\"size-1.5 bg-emerald-500 rounded-full animate-pulse\" /> Disponible Hoy\n                      </p>\n                    </div>\n                  </button>\n                ))\n              ) : (\n                <p className=\"text-center py-10 text-slate-400 font-bold uppercase text-xs\">No hay profesionales disponibles en este momento.</p>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* PASO 2: FORMULARIO DE RESERVA */}\n        {step === 2 && (\n          <form onSubmit={handleConfirm} className=\"animate-in fade-in slide-in-from-right-4 duration-500 bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 border border-slate-200 dark:border-slate-800 shadow-2xl space-y-5\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <button \n                type=\"button\" \n                onClick={() => setStep(1)}\n                className=\"size-10 flex items-center justify-center bg-slate-100 dark:bg-slate-800 rounded-xl text-slate-500 hover:text-blue-600 transition-colors\"\n              >\n                <ChevronLeft size={20} />\n              </button>\n              <h3 className=\"text-[10px] font-black uppercase text-slate-400 tracking-widest\">\n                Detalles del Turno\n              </h3>\n              <div className=\"size-10\" /> {/* Spacer */}\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div className=\"space-y-1.5\">\n                <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">Nombre Completo</label>\n                <input \n                  required \n                  type=\"text\"\n                  placeholder=\"Ej. Juan P√©rez\" \n                  className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\" \n                  onChange={e => setBooking({...booking, customer: e.target.value})} \n                />\n              </div>\n              \n              <div className=\"space-y-1.5\">\n                <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">WhatsApp</label>\n                <input \n                  required \n                  type=\"tel\" \n                  placeholder=\"Tu celular para avisarte\" \n                  className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n                  onChange={e => setBooking({...booking, phone: e.target.value})} \n                />\n              </div>\n\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">Hora</label>\n                  <input \n                    required \n                    type=\"time\" \n                    className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white outline-none focus:ring-2 ring-blue-500 transition-all\"\n                    onChange={e => setBooking({...booking, start: e.target.value})} \n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-[9px] font-black uppercase text-slate-400 ml-4 tracking-widest\">Servicio</label>\n                  <div className=\"relative\">\n                    <select \n                      className=\"w-full bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 py-4 font-bold dark:text-white appearance-none outline-none focus:ring-2 ring-blue-500 transition-all\"\n                      onChange={e => setBooking({...booking, service: e.target.value})}\n                    >\n                      <option value=\"Corte General\">Corte General</option>\n                      <option value=\"Corte y Barba\">Corte y Barba</option>\n                      <option value=\"Perfilado de Barba\">Perfilado de Barba</option>\n                      <option value=\"Corte Kids\">Corte Kids</option>\n                      <option value=\"Color / Reflejos\">Color / Reflejos</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <button \n              type=\"submit\" \n              disabled={isSubmitting}\n              className=\"w-full bg-blue-600 text-white font-black uppercase py-5 rounded-2xl shadow-xl shadow-blue-500/30 hover:bg-blue-700 transition-all mt-6 tracking-widest text-xs flex items-center justify-center gap-2 disabled:opacity-50\"\n            >\n              {isSubmitting ? (\n                <>\n                  <Loader2 className=\"animate-spin\" size={16} /> Procesando...\n                </>\n              ) : (\n                \"Confirmar Mi Turno\"\n              )}\n            </button>\n            <p className=\"text-[8px] font-black text-slate-400 text-center uppercase tracking-tighter\">\n              Al confirmar, te redirigiremos a WhatsApp para notificar a la barber√≠a.\n            </p>\n          </form>\n        )}\n\n        {/* PASO 3: √âXITO */}\n        {step === 3 && (\n          <div className=\"text-center p-10 bg-white dark:bg-slate-900 rounded-[3rem] border border-slate-200 dark:border-slate-800 shadow-2xl animate-in zoom-in-95 duration-500\">\n            <div className=\"size-20 bg-emerald-500 text-white rounded-full flex items-center justify-center mx-auto mb-8 shadow-lg shadow-emerald-500/20\">\n              <CheckCircle2 size={40} />\n            </div>\n            <h2 className=\"text-3xl font-black uppercase dark:text-white tracking-tighter leading-tight\">¬°Turno Confirmado!</h2>\n            <p className=\"text-slate-500 font-bold text-sm mt-4 uppercase\">\n              Agendado con <span className=\"text-blue-600\">{booking.barber}</span> a las <span className=\"text-blue-600\">{booking.start}hs</span>.\n            </p>\n            \n            <div className=\"mt-8 p-6 bg-slate-50 dark:bg-slate-800 rounded-[2rem] border border-slate-100 dark:border-slate-700\">\n              <div className=\"flex flex-col items-center gap-2\">\n                <MapPin size={18} className=\"text-blue-600\" />\n                <p className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest\">Te esperamos en:</p>\n                <p className=\"font-black text-xs dark:text-white uppercase text-center\">{barberia.direccion}</p>\n              </div>\n            </div>\n\n            <div className=\"mt-10 space-y-3\">\n              <div className=\"flex items-center justify-center gap-2 text-blue-500 animate-pulse\">\n                <Loader2 size={14} className=\"animate-spin\" />\n                <p className=\"text-[9px] font-black uppercase tracking-widest\">Abriendo WhatsApp...</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* FOOTER */}\n        <div className=\"mt-12 text-center\">\n          <p className=\"text-[8px] font-black uppercase tracking-widest text-slate-400\">\n            Power by <span className=\"text-blue-600\">BarberPro</span> System\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}"
        }
    ]
}